<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>oracle笔记 | 无为徐生</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/vuepress-blog/icon.png">
    <meta name="description" content="生活随笔-编程笔记-书法练习轨迹">
    
    <link rel="preload" href="/vuepress-blog/assets/css/0.styles.c5cb1392.css" as="style"><link rel="preload" href="/vuepress-blog/assets/js/app.ee30669a.js" as="script"><link rel="preload" href="/vuepress-blog/assets/js/3.9cedbe4c.js" as="script"><link rel="preload" href="/vuepress-blog/assets/js/2.5f0b3217.js" as="script"><link rel="preload" href="/vuepress-blog/assets/js/20.e7530fec.js" as="script"><link rel="preload" href="/vuepress-blog/assets/js/87.a6cc83ea.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/js/1.33058bb1.js"><link rel="prefetch" href="/vuepress-blog/assets/js/100.65184365.js"><link rel="prefetch" href="/vuepress-blog/assets/js/101.fcc33696.js"><link rel="prefetch" href="/vuepress-blog/assets/js/102.47bf3bc1.js"><link rel="prefetch" href="/vuepress-blog/assets/js/103.05dfabff.js"><link rel="prefetch" href="/vuepress-blog/assets/js/104.28c33818.js"><link rel="prefetch" href="/vuepress-blog/assets/js/105.dd8695ad.js"><link rel="prefetch" href="/vuepress-blog/assets/js/106.bb05e9a6.js"><link rel="prefetch" href="/vuepress-blog/assets/js/107.aafd6cae.js"><link rel="prefetch" href="/vuepress-blog/assets/js/108.05ac5505.js"><link rel="prefetch" href="/vuepress-blog/assets/js/109.00141c24.js"><link rel="prefetch" href="/vuepress-blog/assets/js/11.3e329a3b.js"><link rel="prefetch" href="/vuepress-blog/assets/js/110.3a152484.js"><link rel="prefetch" href="/vuepress-blog/assets/js/111.9b496f8b.js"><link rel="prefetch" href="/vuepress-blog/assets/js/112.32fe761a.js"><link rel="prefetch" href="/vuepress-blog/assets/js/113.651cb2aa.js"><link rel="prefetch" href="/vuepress-blog/assets/js/114.b6f94d18.js"><link rel="prefetch" href="/vuepress-blog/assets/js/115.eaea7ce5.js"><link rel="prefetch" href="/vuepress-blog/assets/js/116.cf32ae07.js"><link rel="prefetch" href="/vuepress-blog/assets/js/117.6b2d0b64.js"><link rel="prefetch" href="/vuepress-blog/assets/js/118.e57400b1.js"><link rel="prefetch" href="/vuepress-blog/assets/js/119.9e80f096.js"><link rel="prefetch" href="/vuepress-blog/assets/js/12.073f8190.js"><link rel="prefetch" href="/vuepress-blog/assets/js/120.9350d7b7.js"><link rel="prefetch" href="/vuepress-blog/assets/js/13.4555a927.js"><link rel="prefetch" href="/vuepress-blog/assets/js/14.8933d101.js"><link rel="prefetch" href="/vuepress-blog/assets/js/15.68fdb506.js"><link rel="prefetch" href="/vuepress-blog/assets/js/16.b7f61fa2.js"><link rel="prefetch" href="/vuepress-blog/assets/js/17.d075425b.js"><link rel="prefetch" href="/vuepress-blog/assets/js/18.36cedba5.js"><link rel="prefetch" href="/vuepress-blog/assets/js/19.819534ac.js"><link rel="prefetch" href="/vuepress-blog/assets/js/21.c16b052c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/22.ab6c7ca6.js"><link rel="prefetch" href="/vuepress-blog/assets/js/23.ebc8b624.js"><link rel="prefetch" href="/vuepress-blog/assets/js/24.367c574d.js"><link rel="prefetch" href="/vuepress-blog/assets/js/25.13c60cf0.js"><link rel="prefetch" href="/vuepress-blog/assets/js/26.4bd12aca.js"><link rel="prefetch" href="/vuepress-blog/assets/js/27.9b83a65c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/28.f82d2d05.js"><link rel="prefetch" href="/vuepress-blog/assets/js/29.3ca6118f.js"><link rel="prefetch" href="/vuepress-blog/assets/js/30.ba405f3e.js"><link rel="prefetch" href="/vuepress-blog/assets/js/31.f868abc0.js"><link rel="prefetch" href="/vuepress-blog/assets/js/32.26a06c3e.js"><link rel="prefetch" href="/vuepress-blog/assets/js/33.cba55c46.js"><link rel="prefetch" href="/vuepress-blog/assets/js/34.fdfd39f4.js"><link rel="prefetch" href="/vuepress-blog/assets/js/35.429b7fa2.js"><link rel="prefetch" href="/vuepress-blog/assets/js/36.69ecd097.js"><link rel="prefetch" href="/vuepress-blog/assets/js/37.78c4990e.js"><link rel="prefetch" href="/vuepress-blog/assets/js/38.32005d38.js"><link rel="prefetch" href="/vuepress-blog/assets/js/39.b308c0c9.js"><link rel="prefetch" href="/vuepress-blog/assets/js/4.a2c6ee7d.js"><link rel="prefetch" href="/vuepress-blog/assets/js/40.eba3b538.js"><link rel="prefetch" href="/vuepress-blog/assets/js/41.5476ea14.js"><link rel="prefetch" href="/vuepress-blog/assets/js/42.6e443398.js"><link rel="prefetch" href="/vuepress-blog/assets/js/43.387f8c61.js"><link rel="prefetch" href="/vuepress-blog/assets/js/44.524578d9.js"><link rel="prefetch" href="/vuepress-blog/assets/js/45.e64569e3.js"><link rel="prefetch" href="/vuepress-blog/assets/js/46.e3d9da8b.js"><link rel="prefetch" href="/vuepress-blog/assets/js/47.00f8ed4e.js"><link rel="prefetch" href="/vuepress-blog/assets/js/48.bd1dce8a.js"><link rel="prefetch" href="/vuepress-blog/assets/js/49.cd5a3549.js"><link rel="prefetch" href="/vuepress-blog/assets/js/5.18460ae1.js"><link rel="prefetch" href="/vuepress-blog/assets/js/50.bf507ac1.js"><link rel="prefetch" href="/vuepress-blog/assets/js/51.92430a99.js"><link rel="prefetch" href="/vuepress-blog/assets/js/52.003fef9a.js"><link rel="prefetch" href="/vuepress-blog/assets/js/53.6f0f04eb.js"><link rel="prefetch" href="/vuepress-blog/assets/js/54.d51e9bcd.js"><link rel="prefetch" href="/vuepress-blog/assets/js/55.6b6fa295.js"><link rel="prefetch" href="/vuepress-blog/assets/js/56.dc38dad8.js"><link rel="prefetch" href="/vuepress-blog/assets/js/57.204d377f.js"><link rel="prefetch" href="/vuepress-blog/assets/js/58.db391d6e.js"><link rel="prefetch" href="/vuepress-blog/assets/js/59.7262f2a9.js"><link rel="prefetch" href="/vuepress-blog/assets/js/6.cfba504c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/60.5a197bfd.js"><link rel="prefetch" href="/vuepress-blog/assets/js/61.cdb87900.js"><link rel="prefetch" href="/vuepress-blog/assets/js/62.3ac97494.js"><link rel="prefetch" href="/vuepress-blog/assets/js/63.de0482f5.js"><link rel="prefetch" href="/vuepress-blog/assets/js/64.81652d23.js"><link rel="prefetch" href="/vuepress-blog/assets/js/65.c1ac50bd.js"><link rel="prefetch" href="/vuepress-blog/assets/js/66.2a3ea3a1.js"><link rel="prefetch" href="/vuepress-blog/assets/js/67.63517021.js"><link rel="prefetch" href="/vuepress-blog/assets/js/68.a5deaad9.js"><link rel="prefetch" href="/vuepress-blog/assets/js/69.c330a2a3.js"><link rel="prefetch" href="/vuepress-blog/assets/js/7.0d30306c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/70.a28250a4.js"><link rel="prefetch" href="/vuepress-blog/assets/js/71.b30a94a5.js"><link rel="prefetch" href="/vuepress-blog/assets/js/72.5611cc88.js"><link rel="prefetch" href="/vuepress-blog/assets/js/73.582ac0fc.js"><link rel="prefetch" href="/vuepress-blog/assets/js/74.eba8904a.js"><link rel="prefetch" href="/vuepress-blog/assets/js/75.fb571ab9.js"><link rel="prefetch" href="/vuepress-blog/assets/js/76.616e4d46.js"><link rel="prefetch" href="/vuepress-blog/assets/js/77.14234037.js"><link rel="prefetch" href="/vuepress-blog/assets/js/78.868c70f1.js"><link rel="prefetch" href="/vuepress-blog/assets/js/79.881cb03a.js"><link rel="prefetch" href="/vuepress-blog/assets/js/8.39e6fd7c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/80.6fd51105.js"><link rel="prefetch" href="/vuepress-blog/assets/js/81.c2c2496d.js"><link rel="prefetch" href="/vuepress-blog/assets/js/82.6c62c80e.js"><link rel="prefetch" href="/vuepress-blog/assets/js/83.6fafbcfd.js"><link rel="prefetch" href="/vuepress-blog/assets/js/84.4c2c33bc.js"><link rel="prefetch" href="/vuepress-blog/assets/js/85.71589b9d.js"><link rel="prefetch" href="/vuepress-blog/assets/js/86.8139f2e2.js"><link rel="prefetch" href="/vuepress-blog/assets/js/88.bd999522.js"><link rel="prefetch" href="/vuepress-blog/assets/js/89.c7ca9aaa.js"><link rel="prefetch" href="/vuepress-blog/assets/js/90.5fffec1d.js"><link rel="prefetch" href="/vuepress-blog/assets/js/91.7124c37b.js"><link rel="prefetch" href="/vuepress-blog/assets/js/92.6a49dd40.js"><link rel="prefetch" href="/vuepress-blog/assets/js/93.347d6258.js"><link rel="prefetch" href="/vuepress-blog/assets/js/94.0c161e53.js"><link rel="prefetch" href="/vuepress-blog/assets/js/95.fab08c7e.js"><link rel="prefetch" href="/vuepress-blog/assets/js/96.2ce5b245.js"><link rel="prefetch" href="/vuepress-blog/assets/js/97.904f9620.js"><link rel="prefetch" href="/vuepress-blog/assets/js/98.8ef175c6.js"><link rel="prefetch" href="/vuepress-blog/assets/js/99.7dc7dfbb.js"><link rel="prefetch" href="/vuepress-blog/assets/js/vendors~docsearch.8ec7876f.js">
    <link rel="stylesheet" href="/vuepress-blog/assets/css/0.styles.c5cb1392.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepress-blog/" class="home-link router-link-active"><!----> <span class="site-name">无为徐生</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuepress-blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/vuepress-blog/目录.html" class="nav-link">
  目录
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="生活" class="dropdown-title"><span class="title">生活</span> <span class="arrow down"></span></button> <button type="button" aria-label="生活" class="mobile-dropdown-title"><span class="title">生活</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-blog/生活/随笔/日常Note.html" class="nav-link">
  日常Note
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/生活/随笔/诗文浅作.html" class="nav-link">
  诗文浅作
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/生活/随笔/驾考记事.html" class="nav-link">
  驾考记事
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/生活/随笔/健身与学习.html" class="nav-link">
  健身与学习
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/生活/文档/如何练好书法.html" class="nav-link">
  如何练好书法
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/生活/随笔/我的原神旅行观测记录.html" class="nav-link">
  我的原神旅行观测记录
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程" class="dropdown-title"><span class="title">编程</span> <span class="arrow down"></span></button> <button type="button" aria-label="编程" class="mobile-dropdown-title"><span class="title">编程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-blog/编程/java/javaNote.html" class="nav-link">
  javaNote
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/编程/java/排序算法.html" class="nav-link">
  排序算法
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/编程/运维/gitNote.html" class="nav-link">
  gitNote
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/编程/运维/linuxNote-x.html" class="nav-link">
  linuxNote
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/编程/运维/vuepress构建项目.html" class="nav-link">
  vuepress构建项目
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/编程/数据库/mysqlNote.html" class="nav-link">
  mysqlNote
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/编程/数据库/oracleNote.html" class="nav-link">
  oracleNote
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/编程/资料/javaScript笔记.html" class="nav-link">
  javaScript笔记
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/编程/资料/工具网站readMe.html" class="nav-link">
  工具网站readMe
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="书法" class="dropdown-title"><span class="title">书法</span> <span class="arrow down"></span></button> <button type="button" aria-label="书法" class="mobile-dropdown-title"><span class="title">书法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-blog/书法/书法/赤壁赋.html" class="nav-link">
  赤壁赋
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/书法/书法/多宝塔碑.html" class="nav-link">
  多宝塔碑
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/书法/练习/徐书法.html" class="nav-link">
  徐书法
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/书法/练习/无为徐生.html" class="nav-link">
  无为徐生
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/书法/练习/古文诗词.html" class="nav-link">
  古文诗词
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/书法/练习/书法练习轨迹ReadMe.html" class="nav-link">
  书法练习轨迹
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/书法/轨迹/有感之杂说.html" class="nav-link">
  有感之杂说
</a></li></ul></div></div><div class="nav-item"><a href="/vuepress-blog/关于我.html" class="nav-link">
  关于我
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vuepress-blog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/vuepress-blog/目录.html" class="nav-link">
  目录
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="生活" class="dropdown-title"><span class="title">生活</span> <span class="arrow down"></span></button> <button type="button" aria-label="生活" class="mobile-dropdown-title"><span class="title">生活</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-blog/生活/随笔/日常Note.html" class="nav-link">
  日常Note
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/生活/随笔/诗文浅作.html" class="nav-link">
  诗文浅作
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/生活/随笔/驾考记事.html" class="nav-link">
  驾考记事
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/生活/随笔/健身与学习.html" class="nav-link">
  健身与学习
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/生活/文档/如何练好书法.html" class="nav-link">
  如何练好书法
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/生活/随笔/我的原神旅行观测记录.html" class="nav-link">
  我的原神旅行观测记录
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程" class="dropdown-title"><span class="title">编程</span> <span class="arrow down"></span></button> <button type="button" aria-label="编程" class="mobile-dropdown-title"><span class="title">编程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-blog/编程/java/javaNote.html" class="nav-link">
  javaNote
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/编程/java/排序算法.html" class="nav-link">
  排序算法
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/编程/运维/gitNote.html" class="nav-link">
  gitNote
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/编程/运维/linuxNote-x.html" class="nav-link">
  linuxNote
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/编程/运维/vuepress构建项目.html" class="nav-link">
  vuepress构建项目
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/编程/数据库/mysqlNote.html" class="nav-link">
  mysqlNote
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/编程/数据库/oracleNote.html" class="nav-link">
  oracleNote
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/编程/资料/javaScript笔记.html" class="nav-link">
  javaScript笔记
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/编程/资料/工具网站readMe.html" class="nav-link">
  工具网站readMe
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="书法" class="dropdown-title"><span class="title">书法</span> <span class="arrow down"></span></button> <button type="button" aria-label="书法" class="mobile-dropdown-title"><span class="title">书法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-blog/书法/书法/赤壁赋.html" class="nav-link">
  赤壁赋
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/书法/书法/多宝塔碑.html" class="nav-link">
  多宝塔碑
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/书法/练习/徐书法.html" class="nav-link">
  徐书法
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/书法/练习/无为徐生.html" class="nav-link">
  无为徐生
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/书法/练习/古文诗词.html" class="nav-link">
  古文诗词
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/书法/练习/书法练习轨迹ReadMe.html" class="nav-link">
  书法练习轨迹
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/书法/轨迹/有感之杂说.html" class="nav-link">
  有感之杂说
</a></li></ul></div></div><div class="nav-item"><a href="/vuepress-blog/关于我.html" class="nav-link">
  关于我
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>java</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>运维</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>数据库</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vuepress-blog/编程/数据库/mysqlNote.html" class="sidebar-link">mysqlNote</a></li><li><a href="/vuepress-blog/编程/数据库/oracleNote.html" class="active sidebar-link">oracleNote</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/编程/数据库/oracleNote.html#_1、学习教程" class="sidebar-link">1、学习教程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/编程/数据库/oracleNote.html#_1-1、基础" class="sidebar-link">1.1、基础</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/编程/数据库/oracleNote.html#_1-2、习题" class="sidebar-link">1.2、习题</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/编程/数据库/oracleNote.html#_1-3、数据定义语言-ddl" class="sidebar-link">1.3、数据定义语言 DDL</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/编程/数据库/oracleNote.html#_1-4、索引视图" class="sidebar-link">1.4、索引视图</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/编程/数据库/oracleNote.html#_1-5、声明-declare" class="sidebar-link">1.5、声明 declare</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/编程/数据库/oracleNote.html#_1-6、存储过程" class="sidebar-link">1.6、存储过程</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/编程/数据库/oracleNote.html#_1-7、函数与触发器" class="sidebar-link">1.7、函数与触发器</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuepress-blog/编程/数据库/oracleNote.html#_2、基础操作" class="sidebar-link">2、基础操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/编程/数据库/oracleNote.html#_2-1、登录" class="sidebar-link">2.1、登录</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/编程/数据库/oracleNote.html#_2-2、基础命令" class="sidebar-link">2.2、基础命令</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/编程/数据库/oracleNote.html#_2-3、添加字段" class="sidebar-link">2.3、添加字段</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/编程/数据库/oracleNote.html#_2-4、分页排序" class="sidebar-link">2.4、分页排序</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/编程/数据库/oracleNote.html#_2-5、oracle的数据类型" class="sidebar-link">2.5、oracle的数据类型</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuepress-blog/编程/数据库/oracleNote.html#_3、其他问题" class="sidebar-link">3、其他问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/编程/数据库/oracleNote.html#_3-1、mysql转oracle" class="sidebar-link">3.1、mysql转oracle</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/编程/数据库/oracleNote.html#_3-2、创建外键约束" class="sidebar-link">3.2、创建外键约束</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/编程/数据库/oracleNote.html#_3-3、调整字段顺序" class="sidebar-link">3.3、调整字段顺序</a></li></ul></li></ul></li><li><a href="/vuepress-blog/编程/数据库/ldapNote.html" class="sidebar-link">ldapNote</a></li><li><a href="/vuepress-blog/编程/数据库/redis.html" class="sidebar-link">redis</a></li><li><a href="/vuepress-blog/编程/数据库/mongo.html" class="sidebar-link">mongo</a></li><li><a href="/vuepress-blog/编程/数据库/数据库隔离级别.html" class="sidebar-link">数据库隔离级别</a></li><li><a href="/vuepress-blog/编程/数据库/mysql开启log-bin日志.html" class="sidebar-link">mysql开启log-bin日志</a></li><li><a href="/vuepress-blog/编程/数据库/mysql之explan索引优化说明.html" class="sidebar-link">mysql之explan索引优化说明</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>资料</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="u-valine u-valine-wrap" data-v-91d000da><span data-flag-title="scott180.github.io/vuepress-blog" class="leancloud-visitors" data-v-91d000da><span class="stat update-time" data-v-91d000da><img src="/update-time.png" class="icon" data-v-91d000da>2022-04-23 11:21:40
    </span> <span class="stat read-count" data-v-91d000da><img src="/read-count.png" class="icon" data-v-91d000da> <span class="leancloud-visitors-count" data-v-91d000da></span></span></span></div> <div class="theme-default-content content__default"><h1 id="oracle笔记"><a href="#oracle笔记" class="header-anchor">#</a> oracle笔记</h1> <h2 id="_1、学习教程"><a href="#_1、学习教程" class="header-anchor">#</a> 1、学习教程</h2> <h3 id="_1-1、基础"><a href="#_1-1、基础" class="header-anchor">#</a> 1.1、基础</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>第一课：客户端 
        <span class="token number">1.</span> <span class="token keyword">Sql</span> Plus<span class="token punctuation">(</span>客户端），命令行直接输入：sqlplus，然后按提示输入用户名，密码。  登陆   sqlplus scott<span class="token operator">/</span>tiger<span class="token punctuation">;</span>
        <span class="token number">2.</span> 从开始程序运行:sqlplus，是图形版的sqlplus<span class="token punctuation">.</span>
        <span class="token number">3.</span> http:<span class="token comment">//localhost:5560/isqlplus</span>
        
        Toad：管理， PlSql Developer:


第二课：更改用户
        <span class="token number">1.</span> sqlplus sys<span class="token operator">/</span>bjsxt <span class="token keyword">as</span> sysdba
        <span class="token number">2.</span> <span class="token keyword">alter</span> <span class="token keyword">user</span> scott account <span class="token keyword">unlock</span><span class="token punctuation">;</span><span class="token punctuation">(</span>解锁<span class="token punctuation">)</span>

第三课：<span class="token keyword">table</span> structure      
        <span class="token number">1.</span> 描述某一张表：<span class="token keyword">desc</span> 表名
        <span class="token number">2.</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> 表名
		
第四课：<span class="token keyword">select</span>  查看
       <span class="token number">1.</span>计算数据可以用空表：比如：<span class="token punctuation">.</span><span class="token keyword">select</span> <span class="token number">2</span><span class="token operator">*</span><span class="token number">3</span> <span class="token keyword">from</span> dual

       <span class="token number">2.</span><span class="token keyword">select</span> ename<span class="token punctuation">,</span>sal<span class="token operator">*</span><span class="token number">12</span> annual_sal <span class="token keyword">from</span> emp<span class="token punctuation">;</span>与<span class="token keyword">select</span> ename<span class="token punctuation">,</span>sal<span class="token operator">*</span><span class="token number">12</span> <span class="token string">&quot;annual sal&quot;</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>区别，加双引号保持原大小写。不加全变大写。
       
       <span class="token number">3.</span> <span class="token keyword">select</span> ename <span class="token operator">||</span> <span class="token string">&quot;abcd&quot;</span> 如果连接字符串中含有单引号，用两个单引号代替一个单引号。

第五课：<span class="token keyword">distinct</span>  去重
        <span class="token keyword">select</span> deptno <span class="token keyword">from</span> emp<span class="token punctuation">;</span>
        <span class="token keyword">select</span> <span class="token keyword">distinct</span> deptno <span class="token keyword">from</span> emp<span class="token punctuation">;</span>

        <span class="token keyword">select</span> <span class="token keyword">distinct</span> deptno <span class="token keyword">from</span> emp<span class="token punctuation">;</span>
        <span class="token keyword">select</span> <span class="token keyword">distinct</span> deptno <span class="token punctuation">,</span>job <span class="token keyword">from</span> emp
        去掉deptno<span class="token punctuation">,</span>job两者组合的重复。更多的项，就是这么多项的组合的不重复组合。

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><hr> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>第六课：<span class="token keyword">Where</span>   判断
        <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span>
        <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">&lt;&gt;</span><span class="token number">10</span><span class="token punctuation">;</span>不等于<span class="token number">10</span>        
        <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> ename <span class="token operator">=</span><span class="token string">'bike'</span><span class="token punctuation">;</span>
        <span class="token keyword">select</span> ename<span class="token punctuation">,</span>sal <span class="token keyword">from</span> emp <span class="token keyword">where</span> sal <span class="token operator">between</span> <span class="token number">800</span> <span class="token operator">and</span> <span class="token number">1500</span> <span class="token punctuation">(</span><span class="token operator">&gt;=</span><span class="token number">800</span> <span class="token operator">and</span> <span class="token operator">&lt;=</span><span class="token number">1500</span><span class="token punctuation">)</span>
        空值处理:
        <span class="token keyword">select</span> ename<span class="token punctuation">,</span>sal<span class="token punctuation">,</span>comm <span class="token keyword">from</span> emp <span class="token keyword">where</span> comm <span class="token operator">is</span> <span class="token punctuation">(</span><span class="token operator">not</span><span class="token punctuation">)</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
        <span class="token keyword">select</span> ename<span class="token punctuation">,</span>sal<span class="token punctuation">,</span>comm <span class="token keyword">from</span> emp <span class="token keyword">where</span> ename <span class="token punctuation">(</span> <span class="token operator">not</span><span class="token punctuation">)</span><span class="token operator">in</span> <span class="token punctuation">(</span><span class="token string">'smith'</span><span class="token punctuation">,</span><span class="token string">'king'</span><span class="token punctuation">,</span><span class="token string">'abc'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">select</span> ename <span class="token keyword">from</span> emp <span class="token keyword">where</span> ename <span class="token operator">like</span> <span class="token string">'_A%'</span><span class="token punctuation">;</span>_代表一个字母<span class="token punctuation">,</span><span class="token operator">%</span>代表<span class="token number">0</span>个或多个字母<span class="token punctuation">.</span> 如果查询<span class="token operator">%</span>
        可用转义字符<span class="token punctuation">.</span>\<span class="token operator">%</span><span class="token punctuation">.</span> 还可以用<span class="token keyword">escape</span> <span class="token string">'$'</span>比如:<span class="token keyword">select</span> ename <span class="token keyword">from</span> emp <span class="token keyword">where</span> ename <span class="token operator">like</span> <span class="token string">'%$a%'</span> <span class="token keyword">escape</span> <span class="token string">'$'</span><span class="token punctuation">;</span>

第七课: <span class="token keyword">order</span> <span class="token keyword">by</span>  排序  <span class="token keyword">desc</span><span class="token operator">-</span>倒序
        
         <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> dept<span class="token punctuation">;</span> 
         <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> dept <span class="token keyword">order</span> <span class="token keyword">by</span> dept <span class="token keyword">desc</span><span class="token punctuation">;</span><span class="token punctuation">(</span>默认:<span class="token keyword">asc</span><span class="token punctuation">)</span>
         <span class="token keyword">select</span> ename<span class="token punctuation">,</span>sal<span class="token punctuation">,</span>deptno <span class="token keyword">from</span> emp <span class="token keyword">order</span> <span class="token keyword">by</span> deptno <span class="token keyword">asc</span><span class="token punctuation">,</span>ename <span class="token keyword">desc</span><span class="token punctuation">;</span>

第八课: <span class="token keyword">sql</span> function1:  函数  
        <span class="token keyword">select</span> ename<span class="token punctuation">,</span>sal<span class="token operator">*</span><span class="token number">12</span> annual_sal <span class="token keyword">from</span> emp
        <span class="token keyword">where</span> ename <span class="token operator">not</span> <span class="token operator">like</span> <span class="token string">'_A%'</span> <span class="token operator">and</span> sal<span class="token operator">&gt;</span><span class="token number">800</span>
        <span class="token keyword">order</span> <span class="token keyword">by</span> sal <span class="token keyword">desc</span><span class="token punctuation">;</span>

        <span class="token keyword">select</span> lower<span class="token punctuation">(</span>ename<span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>

        <span class="token keyword">select</span> ename <span class="token keyword">from</span> emp 
        <span class="token keyword">where</span> lower<span class="token punctuation">(</span>ename<span class="token punctuation">)</span> <span class="token operator">like</span> <span class="token string">'_a%'</span><span class="token punctuation">;</span>等同于
        <span class="token keyword">select</span> ename <span class="token keyword">from</span> emp <span class="token keyword">where</span> ename <span class="token operator">like</span> <span class="token string">'_a%'</span> <span class="token operator">or</span> ename <span class="token operator">like</span> <span class="token string">'_A%'</span><span class="token punctuation">;</span>

        <span class="token keyword">select</span> substr<span class="token punctuation">(</span>ename<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>从第二字符截<span class="token punctuation">,</span>一共截三个字符<span class="token punctuation">.</span>
        <span class="token keyword">select</span> chr<span class="token punctuation">(</span><span class="token number">65</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual 结果为:A
        <span class="token keyword">select</span> ascii<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual 结果为:<span class="token number">65</span>
        <span class="token keyword">select</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token number">23.652</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span> 结果为: <span class="token number">23.7</span>
        <span class="token keyword">select</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token number">23.652</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span> <span class="token number">20</span>
  
        <span class="token keyword">select</span> to_char<span class="token punctuation">(</span>sal<span class="token punctuation">,</span><span class="token string">'$99_999_999'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>
        <span class="token keyword">select</span> to_char<span class="token punctuation">(</span>sal<span class="token punctuation">,</span><span class="token string">'L99_999_999'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>人民币符号<span class="token punctuation">,</span>L:代表本地符号

        这个需要掌握牢:
        <span class="token keyword">select</span> hiredate <span class="token keyword">from</span> emp<span class="token punctuation">;</span>
        显示为:
        BIRTHDATE
        <span class="token comment">----------------</span>
        <span class="token number">17</span><span class="token operator">-</span><span class="token number">12</span>月<span class="token operator">-</span><span class="token number">80</span>
        <span class="token comment">----------------</span>

        改为:
        <span class="token keyword">select</span> to_char<span class="token punctuation">(</span>hiredate<span class="token punctuation">,</span><span class="token string">'YYYY-MM-DD HH:MI:SS'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>
        
        显示:
         
        BIRTHDATE
        <span class="token comment">-------------------</span>
        <span class="token number">1980</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">12</span>:<span class="token number">00</span>:<span class="token number">00</span>
        <span class="token comment">-------------------</span>
        
        <span class="token keyword">select</span> to_char<span class="token punctuation">(</span>sysdate<span class="token punctuation">,</span><span class="token string">'YYYY-MM-DD HH24:MI:SS'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span> <span class="token comment">//也可以改为:HH12</span>
        TO_CHAR<span class="token punctuation">(</span>SYSDATE<span class="token punctuation">,</span><span class="token string">'YY
        -------------------
        2007-02-25 14:46:14
        

        to_date函数:
        select ename,hiredate from emp where hiredate &gt; to_date('</span><span class="token number">1981</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">20</span> <span class="token number">12</span>:<span class="token number">34</span>:<span class="token number">56</span><span class="token string">','</span>YYYY<span class="token operator">-</span>MM<span class="token operator">-</span>DD HH24:MI:SS<span class="token string">');
        如果直接写 hiredate&gt;'</span><span class="token number">1981</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">20</span> <span class="token number">12</span>:<span class="token number">34</span>:<span class="token number">56</span><span class="token string">'会出现格式不匹配,因为表中的格式为: DD-MM月-YY.
  
        
        select sal from emp where sal&gt;888.88 无错.但
        select sal from emp where sal&gt;$1,250,00;
        会出现无效字符错误. 
        改为:
        select sal from emp where sal&gt;to_number('</span>$<span class="token number">1.250</span><span class="token number">.00</span><span class="token string">','</span>$<span class="token number">9</span><span class="token punctuation">,</span><span class="token number">999</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token string">');
        
        把空值改为0
        select ename,sal*12+nvl(comm,0) from emp;  //过滤是NVL
        这样可以防止comm为空时,sal*12相加也为空的情况.


第九课: Group function 组函数
        max,min,avg ,count,sum函数
        
        select to_char(avg(sal),'</span><span class="token number">99999999</span><span class="token punctuation">,</span><span class="token number">99</span>'<span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>
       
        <span class="token keyword">select</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>
        结果:<span class="token number">2073.21</span>
          
        <span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span>
        <span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span>ename<span class="token punctuation">)</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span> count某个字段<span class="token punctuation">,</span>如果这个字段不为空就算一个<span class="token punctuation">.</span>
        <span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> deptno<span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>
        <span class="token keyword">select</span> <span class="token function">sum</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>

第十课: <span class="token keyword">Group</span> <span class="token keyword">by</span>语句
        
        需求:现在想求<span class="token punctuation">,</span>求每个部门的平均薪水<span class="token punctuation">.</span>
        <span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp <span class="token keyword">group</span> <span class="token keyword">by</span> deptno<span class="token punctuation">;</span>
        <span class="token keyword">select</span> deptno<span class="token punctuation">,</span>job<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp <span class="token keyword">group</span> <span class="token keyword">by</span> deptno<span class="token punctuation">,</span>job<span class="token punctuation">;</span>
        <span class="token comment">---Group by语句应注意, 出现在select中的字段,如果没出现在组函数中,必须出现在Group by语句中.</span>

       求薪水值最高的人的名字<span class="token punctuation">.</span>
       <span class="token keyword">select</span> ename<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>出错<span class="token punctuation">,</span>因为max只有一个值<span class="token punctuation">,</span>但等于max值的人可能好几个<span class="token punctuation">,</span>不能匹配<span class="token punctuation">.</span>
       应如下求:
       <span class="token keyword">select</span> ename <span class="token keyword">from</span> emp <span class="token keyword">where</span> sal<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br></div></div><hr> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code> 
    
  第十一课: <span class="token keyword">Having</span> 对分组结果筛选
       
       <span class="token keyword">Where</span>是对单条纪录进行筛选<span class="token punctuation">,</span><span class="token keyword">Having</span>是对分组结果进行筛选<span class="token punctuation">.</span>
      
       <span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span><span class="token punctuation">,</span>deptno <span class="token keyword">from</span> emp 
       <span class="token keyword">group</span> <span class="token keyword">by</span> deptno 
       <span class="token keyword">having</span> <span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">2000</span><span class="token punctuation">;</span>
       
       查询工资大于<span class="token number">1200</span>雇员<span class="token punctuation">,</span>按部门编号进行分组<span class="token punctuation">,</span>分组后平均薪水大于<span class="token number">1500</span><span class="token punctuation">,</span>按工薪倒充排列<span class="token punctuation">.</span>
       <span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp 
       <span class="token keyword">where</span> sal<span class="token operator">&gt;</span><span class="token number">1200</span>
       <span class="token keyword">group</span> <span class="token keyword">by</span> deptno
       <span class="token keyword">having</span> <span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1500</span>
       <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">desc</span><span class="token punctuation">;</span>
        
   第十二课:自查询
       
       谁挣的钱最多<span class="token punctuation">(</span>谁:这个人的名字<span class="token punctuation">,</span>  钱最多<span class="token punctuation">)</span>
       
       <span class="token keyword">select</span> 语句中嵌套<span class="token keyword">select</span> 语句<span class="token punctuation">,</span>可以在<span class="token keyword">where</span><span class="token punctuation">,</span><span class="token keyword">from</span>后<span class="token punctuation">.</span>
       
             
       问那些人工资<span class="token punctuation">,</span>在平均工资之上<span class="token punctuation">.</span>
       
       <span class="token keyword">select</span> ename<span class="token punctuation">,</span>sal <span class="token keyword">from</span> emp <span class="token keyword">where</span> sal<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">-------多表查询</span>

       查找每个部门挣钱最多的那个人的名字<span class="token punctuation">.</span>
       <span class="token keyword">select</span> ename <span class="token punctuation">,</span>deptno <span class="token keyword">from</span> emp <span class="token keyword">where</span> sal <span class="token operator">in</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> ename <span class="token keyword">group</span> <span class="token keyword">by</span> deptno<span class="token punctuation">)</span> 查询会多值<span class="token punctuation">.</span>

       应该如下:
       
       <span class="token keyword">select</span>  <span class="token function">max</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span><span class="token punctuation">,</span>deptno <span class="token keyword">from</span> emp <span class="token keyword">group</span> <span class="token keyword">by</span> deptno<span class="token punctuation">;</span>当成一个表<span class="token punctuation">.</span>语句如下:
       <span class="token keyword">select</span> ename<span class="token punctuation">,</span> sal <span class="token keyword">from</span> emp <span class="token keyword">join</span><span class="token punctuation">(</span><span class="token keyword">select</span>  <span class="token function">max</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> max_sal<span class="token punctuation">,</span>deptno <span class="token keyword">from</span> emp <span class="token keyword">group</span>
       <span class="token keyword">by</span> deptno<span class="token punctuation">)</span> t <span class="token keyword">on</span><span class="token punctuation">(</span>emp<span class="token punctuation">.</span>sal<span class="token operator">=</span>t<span class="token punctuation">.</span>max_sal <span class="token operator">and</span> emp<span class="token punctuation">.</span>deptno<span class="token operator">=</span>t<span class="token punctuation">.</span>deptno<span class="token punctuation">)</span><span class="token punctuation">;</span> 
       
       每个部门的平均薪水的等级<span class="token punctuation">.</span> 
       分析:首先求平均薪水<span class="token punctuation">(</span>当成表<span class="token punctuation">)</span><span class="token punctuation">,</span>把平均薪水和另外一张表连接<span class="token punctuation">.</span>
       <span class="token keyword">join</span>是连接两个表，而<span class="token keyword">on</span>是表示这两个表通过某种条件连接 
       
第十四课:self_table_connection
       
       把某个人的名字以及他的经理人的名字求出来<span class="token punctuation">(</span>经理人及这个人在表中同处一行<span class="token punctuation">)</span>
       
       分析:首先求出这个人的名字<span class="token punctuation">,</span>取他的编号<span class="token punctuation">,</span>然后从另一张表与其相对应编号<span class="token punctuation">,</span>然后找到经理的名字<span class="token punctuation">.</span>
       
       <span class="token keyword">select</span> e1<span class="token punctuation">.</span>ename <span class="token punctuation">,</span>e2<span class="token punctuation">.</span>ename <span class="token keyword">from</span> emp e1<span class="token punctuation">,</span>emp e2 <span class="token keyword">where</span> e1<span class="token punctuation">.</span>mgr<span class="token operator">=</span> e2<span class="token punctuation">.</span>empno<span class="token punctuation">.</span>
       
       empno编号和MGR都是编号<span class="token punctuation">.</span>


第十五课: SQL1999_table_connections    
         
      <span class="token keyword">select</span> ename<span class="token punctuation">,</span>dname<span class="token punctuation">,</span>grade <span class="token keyword">from</span> emp e<span class="token punctuation">,</span>dept d<span class="token punctuation">,</span> sqlgrade s
      <span class="token keyword">where</span> e<span class="token punctuation">.</span>deptno <span class="token operator">=</span> d<span class="token punctuation">.</span>deptno <span class="token operator">and</span> e<span class="token punctuation">.</span><span class="token keyword">sql</span> <span class="token operator">between</span> s<span class="token punctuation">.</span>losal <span class="token operator">and</span> s<span class="token punctuation">.</span>hisal <span class="token operator">and</span>
      job<span class="token operator">&lt;&gt;</span><span class="token string">'CLERK'</span><span class="token punctuation">;</span>
      
      有没有办法把过滤条件和连接条件分开来? 出于这样考虑<span class="token punctuation">,</span>Sql1999标准推出来了<span class="token punctuation">.</span>有许多人用的还是
      旧的语法<span class="token punctuation">,</span>所以得看懂这种语句<span class="token punctuation">.</span>
      
      
      
      <span class="token keyword">select</span> ename<span class="token punctuation">,</span>dname <span class="token keyword">from</span> emp<span class="token punctuation">,</span>dept<span class="token punctuation">;</span><span class="token punctuation">(</span>旧标准<span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token keyword">select</span> ename<span class="token punctuation">,</span>dname <span class="token keyword">from</span> emp <span class="token keyword">cross</span> <span class="token keyword">join</span> dept<span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token number">1999</span>标准<span class="token punctuation">)</span>
       
      <span class="token keyword">select</span> ename<span class="token punctuation">,</span>dname <span class="token keyword">from</span> emp<span class="token punctuation">,</span>dept <span class="token keyword">where</span> emp<span class="token punctuation">.</span>deptno<span class="token operator">=</span>dept<span class="token punctuation">.</span>deptno <span class="token punctuation">(</span>旧<span class="token punctuation">)</span> 
      <span class="token keyword">select</span> ename<span class="token punctuation">,</span>dname <span class="token keyword">from</span> emp <span class="token keyword">join</span> dept <span class="token keyword">on</span><span class="token punctuation">(</span>emp<span class="token punctuation">.</span>deptno <span class="token operator">=</span> dept<span class="token punctuation">.</span>deptno<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token number">1999</span>标准<span class="token punctuation">.</span>没有<span class="token keyword">Where</span>语句<span class="token punctuation">.</span>
      <span class="token keyword">select</span> ename<span class="token punctuation">,</span>dname <span class="token keyword">from</span> emp <span class="token keyword">join</span> dept <span class="token keyword">using</span><span class="token punctuation">(</span>deptno<span class="token punctuation">)</span><span class="token punctuation">;</span>等同上句<span class="token punctuation">,</span>但不推荐使用<span class="token punctuation">.</span>
      
      <span class="token keyword">select</span> ename<span class="token punctuation">,</span>grade <span class="token keyword">from</span> emp e <span class="token keyword">join</span> salgrade s <span class="token keyword">on</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>sal <span class="token operator">between</span> s<span class="token punctuation">.</span>losal <span class="token operator">and</span> s<span class="token punctuation">.</span>hisal<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">join</span> 连接语句<span class="token punctuation">,</span> <span class="token keyword">on</span>过滤条件。连接，条件一眼分开。如果用<span class="token keyword">Where</span>语句较长时，连接语句和过滤语句混在一起。
      
      三张表连接：
      slect ename<span class="token punctuation">,</span>dname<span class="token punctuation">,</span> grade <span class="token keyword">from</span> 
      emp e <span class="token keyword">join</span> dept d <span class="token keyword">on</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>deptno<span class="token operator">=</span>d<span class="token punctuation">.</span>deptno<span class="token punctuation">)</span>
      <span class="token keyword">join</span> salgrade s <span class="token keyword">on</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>sal <span class="token operator">between</span> s<span class="token punctuation">.</span>losal <span class="token operator">and</span> s<span class="token punctuation">.</span>hisal<span class="token punctuation">)</span>
      <span class="token keyword">where</span> ename <span class="token operator">not</span> <span class="token operator">like</span> <span class="token string">'_A%'</span><span class="token punctuation">;</span>
      把每张表连接 条件不混在一起，然后数据过滤条件全部区分开来。读起来更清晰，更容易懂一点。
      
      <span class="token keyword">select</span> e1<span class="token punctuation">.</span>ename<span class="token punctuation">,</span>e2<span class="token punctuation">.</span>ename <span class="token keyword">from</span> emp e1 <span class="token keyword">join</span> emp e2 <span class="token keyword">on</span><span class="token punctuation">(</span>e1<span class="token punctuation">.</span>mgr <span class="token operator">=</span> e2<span class="token punctuation">.</span>emptno<span class="token punctuation">)</span><span class="token punctuation">;</span>

      左外连接：会把左边这张表多余数据显示出来。
      <span class="token keyword">select</span> e1<span class="token punctuation">.</span>ename<span class="token punctuation">,</span>e2<span class="token punctuation">,</span>ename <span class="token keyword">from</span> emp e1 <span class="token keyword">left</span> <span class="token keyword">join</span> emp e2 <span class="token keyword">on</span><span class="token punctuation">(</span>e1<span class="token punctuation">.</span>mgr <span class="token operator">=</span>e2<span class="token punctuation">.</span>empno<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">left</span> 后可加<span class="token keyword">outer</span>
      右外连接：
    <span class="token keyword">select</span> ename<span class="token punctuation">,</span>dname <span class="token keyword">from</span> emp e <span class="token keyword">right</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> dept d <span class="token keyword">on</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>deptno <span class="token operator">=</span>d<span class="token punctuation">.</span>deptno<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">outer</span>可以取掉。
        
      即把左边多余数据，也把右边多余数据拿出来，全外连接。
      <span class="token keyword">select</span> ename<span class="token punctuation">,</span>dname <span class="token keyword">from</span> emp e <span class="token keyword">full</span> <span class="token keyword">join</span> dept d <span class="token keyword">on</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>deptno <span class="token operator">=</span>d<span class="token punctuation">.</span>deptno<span class="token punctuation">)</span><span class="token punctuation">;</span> 

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br></div></div><h3 id="_1-2、习题"><a href="#_1-2、习题" class="header-anchor">#</a> 1.2、习题</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>
16-23 课：求部门平均薪水的等级

       A.求部门平均薪水的等级。

       select deptno,avg_sal,grade from 
       (select deptno,avg(sal) avg_sal from emp group by deptno)t
       join salgrade s on(t.avg_sal between s.losal and s.hisal)
       
       B.求部门平均的薪水等级
       select deptno,avg(grade) from 
       (select deptno,ename, grade from emp join salgrade s on(emp.sal between s.losal and
       s.hisal)) t
       group by deptno

       C.那些人是经理
       select ename from emp where empno in(select mgr from emp);
       select ename from emp where empno in(select distinct mgr from emp);
       
       D.不准用组函数，求薪水的最高值（面试题）
       
       select distinct sal from emp where sal not in(
       select distinct e1.sal from emp e1 join emp e2 on (e1.sal&lt;e2.sal));
       
       E.平均薪水最高的部门编号
       
       select deptno,avg_sal from
       (select avg(sal)avg_sal,deptno from emp group by deptno)
       where avg_sal=
       (select max(avg_sal)from 
       (select avg(sal) avg_sal,deptno from emp group by deptno)
       )
      
       F.平均薪水最高的部门名称
       select dname from dept where deptno=
      ( 
        select deptno from
        (select avg(sal)avg_sal,deptno from emp group by deptno)
        where avg_sal=
        (select max(avg_sal)from 
        (select avg(sal) avg_sal,deptno from emp group by deptno)
        )
       )
      
      G.求平均薪水的等级最低的部门的部门名称
        
        组函数嵌套
        如：平均薪水最高的部门编号，可以E.更简单的方法如下：
        select deptno,avg_sal from 
        (select avg(sal) avg_sal,deptno from emp group by deptno)
        where avg_sal =
        (select max(avg(sal)) from emp group by deptno)
        
        组函数最多嵌套两层
        
        分析：
        首先求
        1.平均薪水： select avg(sal) from group by deptno;

        2.平均薪水等级：  把平均薪水当做一张表，需要和另外一张表连接salgrade
        select  deptno,grade avg_sal from 
          ( select deptno,avg(sal) avg_sal from emp group by deptno) t
        join salgrade s on(t.avg_sal between s.losal and s.hisal)
        
        上面结果又可当成一张表。
        
        DEPTNO    GRADE    AVG_SAL
      --------  -------  ----------
        30           3   1566.66667
        20           4   2175
        10           4   2916.66667

        3.求上表平均等级最低值
        
        select min(grade) from
        (
          select deptno,grade,avg_sal from
           (select deptno,avg(sal) avg_sal from emp group by deptno)t
          join salgrade s on(t.avg_sal between s.losal and s.hisa)
         )

        4.把最低值对应的2结果的那张表的对应那张表的deptno, 然后把2对应的表和另外一张表做连接。
          
          select dname ,deptno,grade,avg_sal from
            (
  	      select deptno,grade,avg_sal from
              (select deptno,avg(sal) avg_sal from emp group by deptno)t
             join salgrade s on(t.avg_sal between s.losal and s.hisal)
             ) t1
            join dept on (t1.deptno = dept.deptno)
            where t1.grade =
            ( 
              select deptno,grade,avg_sal from
               (select deptno,avg(sal) avg_sal from emp group by deptno) t
                join salgrade s on(t.avg_sal between s.losal and s.hisal)
               )
            )
         结果如下：
         
        DNAME    DEPTNO     GRADE    AVG_SAL
      --------  -------  --------   --------
        SALES        30        3    1566.6667 
     
         
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code>有<span class="token number">3</span>个表S，C，SC 
S（SNO，SNAME）代表（学号，姓名） 
C（CNO，CNAME，CTEACHER）代表（课号，课名，教师） 
SC（SNO，CNO，SCGRADE）代表（学号，课号，成绩） 
问题： 
<span class="token number">1</span>，找出没选过“黎明”老师的所有学生姓名。 
<span class="token number">2</span>，列出<span class="token number">2</span>门以上（含<span class="token number">2</span>门）不及格学生姓名及平均成绩。 
<span class="token number">3</span>，即学过<span class="token number">1</span>号课程有学过<span class="token number">2</span>号课所有学生的姓名。 
请用标准<span class="token keyword">SQL</span>语言写出答案，方言也行（请说明是使用什么方言）。

<span class="token number">1.</span>
<span class="token keyword">select</span> sname <span class="token keyword">from</span> s <span class="token keyword">where</span> sno <span class="token operator">in</span> <span class="token punctuation">(</span> <span class="token keyword">select</span> sno <span class="token keyword">from</span> sc <span class="token keyword">where</span> cno <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> cno <span class="token keyword">from</span> c <span class="token keyword">where</span> cteacher<span class="token operator">=</span><span class="token string">'黎明'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">select</span> sname <span class="token keyword">from</span> s <span class="token keyword">join</span> sc <span class="token keyword">on</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>sno<span class="token operator">=</span>sc<span class="token punctuation">.</span>sno<span class="token punctuation">)</span> <span class="token keyword">join</span> c <span class="token keyword">on</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>cno<span class="token operator">=</span>sc<span class="token punctuation">.</span>cno<span class="token punctuation">)</span> <span class="token keyword">where</span> c<span class="token punctuation">.</span>cteacher<span class="token operator">&lt;&gt;</span><span class="token string">'黎明'</span>

<span class="token number">2.</span>
<span class="token keyword">select</span> s<span class="token punctuation">.</span>sname<span class="token punctuation">,</span>scc<span class="token punctuation">.</span>a <span class="token keyword">from</span> s <span class="token keyword">join</span> <span class="token punctuation">(</span><span class="token keyword">select</span> sno<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>sno<span class="token punctuation">)</span> c<span class="token punctuation">,</span><span class="token function">avg</span><span class="token punctuation">(</span>scgrade<span class="token punctuation">)</span> a <span class="token keyword">from</span> sc <span class="token keyword">where</span> scgrade<span class="token operator">&lt;</span>
<span class="token number">60</span> <span class="token keyword">group</span> <span class="token keyword">by</span> sno<span class="token punctuation">)</span> scc <span class="token keyword">on</span><span class="token punctuation">(</span>scc<span class="token punctuation">.</span>sno<span class="token operator">=</span>s<span class="token punctuation">.</span>sno <span class="token operator">and</span> scc<span class="token punctuation">.</span>c<span class="token operator">&gt;=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token number">3.</span>
<span class="token keyword">select</span> sname <span class="token keyword">from</span> s <span class="token keyword">where</span> s<span class="token punctuation">.</span>sno <span class="token operator">in</span><span class="token punctuation">(</span><span class="token keyword">select</span> sno <span class="token keyword">from</span> sc <span class="token keyword">where</span> cno<span class="token operator">=</span><span class="token number">101</span><span class="token punctuation">)</span> <span class="token operator">and</span>  s<span class="token punctuation">.</span>sno <span class="token operator">in</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">distinct</span> sno <span class="token keyword">from</span> sc <span class="token keyword">where</span> cno<span class="token operator">=</span><span class="token number">102</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


数据库有<span class="token number">3</span>个表 teacher表 student表 tea_stu关系表 teacher表 teaID name age student表 stuID name age teacher_student表 teaID stuID 要求用一条<span class="token keyword">sql</span>查询出这样的结果: <span class="token number">1.</span>显示的字段要有老师id age 每个老师所带的学生人数 <span class="token number">2.</span>只列出老师age为<span class="token number">40</span>以下 学生age为<span class="token number">12</span>以上的记录。


<span class="token keyword">select</span> t<span class="token punctuation">.</span>teaID<span class="token punctuation">,</span>t<span class="token punctuation">.</span>age<span class="token punctuation">,</span>tc<span class="token punctuation">.</span>co <span class="token keyword">from</span> teacher t <span class="token keyword">join</span><span class="token punctuation">(</span>
<span class="token keyword">select</span> tID<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> co <span class="token keyword">from</span> <span class="token punctuation">(</span>
<span class="token keyword">select</span> tc<span class="token punctuation">.</span>teaID tID<span class="token punctuation">,</span>t<span class="token punctuation">.</span>stuID <span class="token keyword">from</span> teacher_student tc <span class="token keyword">join</span> student s <span class="token keyword">where</span> s<span class="token punctuation">.</span>age<span class="token operator">&gt;</span><span class="token number">12</span>
<span class="token keyword">on</span><span class="token punctuation">(</span>tc<span class="token punctuation">.</span>stuID<span class="token operator">=</span>t<span class="token punctuation">.</span>stuID<span class="token punctuation">)</span> <span class="token keyword">join</span> teacher t <span class="token keyword">where</span> t<span class="token punctuation">.</span>age<span class="token operator">&lt;</span><span class="token number">40</span> <span class="token keyword">on</span><span class="token punctuation">(</span>tc<span class="token punctuation">.</span>teaID<span class="token operator">=</span>t<span class="token punctuation">.</span>teaID<span class="token punctuation">)</span> <span class="token punctuation">)</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> tID <span class="token punctuation">)</span> scc  <span class="token keyword">on</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>teaID<span class="token operator">=</span>scc<span class="token punctuation">.</span>tID<span class="token punctuation">)</span>


<span class="token keyword">select</span> a<span class="token punctuation">.</span>teaID<span class="token punctuation">,</span>a<span class="token punctuation">.</span>age <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> teacher a<span class="token punctuation">,</span>student b<span class="token punctuation">,</span>teacher_student c
<span class="token keyword">where</span> a<span class="token punctuation">.</span>teaID<span class="token operator">=</span>c<span class="token punctuation">.</span>teaID
<span class="token operator">and</span> b<span class="token punctuation">.</span>stuID<span class="token operator">=</span>c<span class="token punctuation">.</span>stuID
<span class="token operator">and</span> a<span class="token punctuation">.</span>age<span class="token operator">&gt;</span><span class="token number">40</span>
<span class="token operator">and</span> b<span class="token punctuation">.</span>age<span class="token operator">&gt;</span><span class="token number">12</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> a<span class="token punctuation">.</span>teaID<span class="token punctuation">,</span>a<span class="token punctuation">.</span>age<span class="token punctuation">;</span>


建表  增删改查  plsql 存储过程 

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h3 id="_1-3、数据定义语言-ddl"><a href="#_1-3、数据定义语言-ddl" class="header-anchor">#</a> 1.3、数据定义语言 DDL</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>
数据定义语言（DDL）:create,alter,drop     （需要加table）
数据操纵语言（DML）:insert,delete,update,select (增删改查）
数据控制语言（DCL）:grant,revoke
事务控制语言（TCL）:commit,savepoint,rollback



数据定义语言（DDL）:create,alter,drop  （需要加table，主要对表起作用）
----创建表create table emp2 as select * from emp;
创建表的约束条件  not null 非空   unique 唯一   primary key 主键-唯一非空(不可删除）  check 检查
reference  外键约束被参考的键必须是主键primary key （如emp的deptno参考dept的deptno，则dept的deptno必须是主键）

sex varchar2(10) check (sex in ('男','女'));  check约束

create table te(
emono number(4) primary key,
ename varchar2(10) not null,
job varchar2(12),
sal number(7,2),
id number(6) unique);


-----创建表级约束constraint stu_sno_cno_uni unique(sno,cno)  
create table sc(
sno number(20) references s(sno),
cno number(10) references c(cno),
scgrade number(2),
constraint stu_sno_cno_uni unique(sno,cno)
)

----删除表drop table emp2；
drop table emp2 purge;  彻底删除表   purge recyclebin；清空回收站

----修改表结构  alter
alter table emp2 add(loc varchar(10));
alter table emp2 modify (loc varchar(20));
ALTER TABLE old_table_name RENAME TO new_table_name;(大写为系统命令)
alter table emp rename column empno to eo;



数据操纵语言（DML）:insert,delete,update,select (增删改查，主要对列起作用）
--插入数据 insert into dept2 values (50,'game','hf');
           insert into dept2(deptno,dname) values(60,'producer');
	   insert into dept2 select * from dept;

--删除数据 delete from dept2 where deptno&gt;30;

--更新数据 update dept2 set deptno=deptno+1;

commit;  提交          rollback; 回退

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div></div><hr> <h3 id="_1-4、索引视图"><a href="#_1-4、索引视图" class="header-anchor">#</a> 1.4、索引视图</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>
数据字典表 dictionary
select table_name from user_tables;
select table_name from dictionary where table_name like 'USER%' order by table_name;


索引index --读取数据速度快，但是更改速度慢,主键也是索引
查看索引  select index_name from user_indexes;
创建索引  create index idx_stu_email on stu(email);

视图view --就是子查询，使用方便，保护隐私。增加维护成本
查看视图  select view_name from user_views;
创建视图  create view v$_emp_deptno_avg_sal as select deptno,avg(sal) avg_sal from emp group by deptno;


序列 sequence --number 自动递增
创建序列  create sequence seq；
使用序列  select seq.nextval from dual;


  H: 视图（视图就是一张表，一个字查询）
        
       G中语句有重复，可以用视图来简化。
       conn sys/bjsxt as sysdba;
       grant create table,create view to scott;
       conn scott/tiger
       创建视图：
       create view v$_dept_avg-sal_info as
       select deptno,grade,avg_sal from
        ( select deptno,avg(sal) avg_sal from emp group by deptno)t
       join salgrade s on 9t.avg_sal between s.losal and s.hisal)
      
       然后 
       select * from v$_dept_avg-sal_info
       
       结果如下：
       DEPTNO      GRADE    AVG_SAL
      --------  -------  ----------
        30           3   1566.66667
        20           4   2175
        10           4   2916.66667

       然后G中查询可以简化成：
       select  dname,t1.deptno,grade,avg_sal from
       v$_dept_avg-sal_info t1
       join dept on9t1.deptno =dept.deptno)
       where t1.grade=
       (
	select min(grade) from v$_dept_avg-sal_info t1
       ) 


三范式--消除冗余数据 
第一范式：表要有主键，列不可分（唯一非空，不可重复；字段不可再分割）。
第二范式：多个字段组合成主键，其他字段不能依赖部分的主键。不能部分依赖。实体的属性完全依赖于主关键字。
第三范式：不能存在传递依赖。要求一个数据库表中不包含已在其它表中已包含的非主关键字信息。


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br></div></div><hr> <h3 id="_1-5、声明-declare"><a href="#_1-5、声明-declare" class="header-anchor">#</a> 1.5、声明 declare</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>
plsql    过程化SQL语言（Procedural Language/SQL）
dbms     database mangement system 数据库管理系统
declare  声明

--打开输出 set serveroutput on;

--输出
begin
dbms_output.put_line('hello_world');
end;
/


--赋值 := 
 declare
 v_name varchar(20);
 begin
 v_name := 'hello';
 dbms_output.put_line(v_name);
 end;
 /


--异常 exception  when others then
declare
v_num number(10) :=2;
begin
v_num := v_num/0;
dbms_output.put_line(v_num);
exception
when others then
dbms_output.put_line('error');
end;
/


oracle的数据类型  binary_integer:整数，主要用来计数    long  长字符串，最长2G
constant  相当于java的final
oracle的boolean有三个值 true，false，null   但是不可打印
oracle的字符串连接符是 || ,相当于java的 +  
oracle的双引号是用两个单引号表示
赋值是 := 



declare
v_name varchar2(10);
v_id number := 20;
v_empno emp.empno%type;
v_empno1 v_empno%type;
v_pi constant number(7,2) :=3.14;
begin
v_empno := 3113;
dbms_output.put_line('v_empno'||v_empno);
end;



--变量声明，使用%type属性
 	declare
	  v_empno number(4);
	  v_empno2 emp.empno%type;
	  v_empno3 v_empno2%type;
	begin
	  dbms_output.put_line('test');
	end;

--table变量类型(数组)
declare
   type type_table_emp_empno is table of emp.empno%type index by binary_integer;
      v_empnos type_table_emp_empno;
begin
   v_empnos(0) := 7369;
    v_empnos(2) := 7839;
    v_empnos(-1) := 9999;
    dbms_output.put_line(v_empnos(-1));
end;


--record变量类型（近似java中的类）
declare
  type type_record_dept is record
      (
        deptno dept.deptno%type,
        dname dept.dname%type,
        loc dept.loc%type
      );
    v_temp type_record_dept;
begin
  v_temp.deptno := 50;
  v_temp.dname := 'aaa';
  v_temp.loc := 'bj';
  dbms_output.put_line(v_temp.deptno || ' ' || v_temp.dname);
end;


--使用%rowtype声明record变量   -------------------------------------------
declare
  v_temp dept%rowtype;
begin
    v_temp.deptno := 50;
    v_temp.dname := 'aaa';
    v_temp.loc := 'bj';
   dbms_output.put_line(v_temp.deptno || ' ' || v_temp.dname);
end;


--SQL语句的运用
--select语句  --有且只有一条返回语句   into  --------------------------------
declare
     v_name emp.ename%type;
     v_sal emp.sal%type;
begin
   select ename, sal into v_name, v_sal from emp where empno = 7369;
   dbms_output.put_line(v_name || ' ' || v_sal);
end;


declare
    v_emp emp%rowtype;
begin
  select * into v_emp from emp where empno = 7369;
  dbms_output.put_line(v_emp.ename);
end;

--insert语句

declare
    v_deptno dept.deptno%type := 50;
    v_dname dept.dname%type := 'aaa';
    v_loc dept.loc%type := 'bj';
begin
  insert into dept2 values(v_deptno, v_dname, v_loc);
 commit;
end;

--sql%rowcount  sql是指刚刚执行的语句，rowcount是有多少条语句被影响，一般与update，delete同时使用
declare
   v_deptno emp2.deptno%type := 10;
   v_count number;
begin
  --update emp2 set sal = sal/2 where deptno = v_deptno;
  --select deptno into v_deptno from emp2 where empno = 7369;
  select count(*) into v_count from emp2;
  dbms_output.put_line(sql%rowcount || '条记录被影响');
 commit;
end;

DDL语句 ''aaa'' 双引号用两个单引号表示
begin
     execute immediate 'create table t (nnn varchar2(20) default ''aaa'')';
end;


--if语句   if() then  ;elsif() then  ;else  ;end if;   注意是 elsif
取出7369的薪水，如果&lt;1200，输出'low'，如果&lt;2000输出'middle'，否则'high'

declare
    v_sal emp.sal%type;
begin
   select sal into v_sal from emp
          where empno = 7369;
   if (v_sal &lt; 1200) then
         dbms_output.put_line('low');
   elsif (v_sal &lt; 2000) then
         dbms_output.put_line('middle');
   else
         dbms_output.put_line('high');
   end if;
end;

--练习



--循环
declare
   i binary_integer := 1;
begin
   loop
      dbms_output.put_line(i);
           i := i + 1;
           exit when (i &gt;= 11);
   end loop;
end;
---------

declare
   j binary_integer := 1;
begin
  while j &lt; 11 loop
      dbms_output.put_line(j);
          j := j + 1;
  end loop;
end;

-----------
begin
    for k in 1..10 loop
       dbms_output.put_line(k);
    end loop;

    for k in reverse 1..10 loop
        dbms_output.put_line(k);
     end loop;
end;

--错误处理
declare
   v_temp number(4);
begin
   select empno into v_temp from emp where empno = 10;
exception
   when too_many_rows then
      dbms_output.put_line('太多纪录了');
   when others then
      dbms_output.put_line('error');
end;

----------

declare
   v_temp number(4);
begin
   select empno into v_temp from emp where empno = 2222;
exception
   when no_data_found then
      dbms_output.put_line('没有数据');
end;

---------
--创建事件日志表
create table errorlog
(
id number primary key,
errcode number,
errmsg varchar2(1024),
errdate date
)
--创建序列
create sequence seq_errorlog_id start with 1 increment by 1 
--实验
declare
   v_deptno dept.deptno%type := 10;
   v_errcode number;
   v_errmsg varchar2(1024);
begin
   delete from dept where deptno = v_deptno;
 commit;
exception
   when others then
      rollback;
         v_errcode := SQLCODE;
         v_errmsg := SQLERRM;
      insert into errorlog values (seq_errorlog_id.nextval, v_errcode, v_errmsg, sysdate);
      commit;
end;

--游标   类似java中的迭代器
declare
   cursor c is
            select * from emp;
   v_temp c%rowtype;
begin
    open c;
    fetch c into v_temp;
    dbms_output.put_line(v_temp.ename);
    close c;
end;


------------------
declare
    cursor c is
       select * from emp;
    v_emp c%rowtype;
begin
    open c;
    loop
      fetch c into v_emp;
      exit when (c%notfound);
      dbms_output.put_line(v_emp.ename);
    end loop;
    close c;
end;


----------------------while循环  两个fetch c into v_emp
declare
    cursor c is
       select * from emp;
    v_emp c%rowtype;
begin
    open c;
    fetch c into v_emp;
    while (c%found) loop
      dbms_output.put_line(v_emp.ename);
      fetch c into v_emp;
    end loop;
    close c;
end;


-----------------for 循环：没有打开，关闭cursor，也没有fetch 。默认 v_emp c%rowtype;
declare
    cursor c is
       select * from emp;
begin
   for v_emp in c loop
        dbms_output.put_line(v_emp.ename);
    end loop;
end;


--带参数的游标
declare
   cursor c (v_deptno emp.deptno%type, v_job emp.job%type)
   is
     select ename, sal from emp where deptno = v_deptno and job = v_job;
begin
   for v_temp in c(30,'CLERK') loop
      dbms_output.put_line(v_temp.ename);
   end loop;
end;


--可更新的游标
declare
  cursor c
  is
    select * from emp2 for update;
begin
   for v_temp in c loop
      if (v_temp.sal &lt; 2000) then
         update emp2 set sal = sal * 2 where current of c;
      elsif (v_temp.sal = 5000) then
         delete from emp2 where current of c;
      end if;
    end loop;
    commit;
end;
----------------

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br><span class="line-number">319</span><br><span class="line-number">320</span><br><span class="line-number">321</span><br><span class="line-number">322</span><br><span class="line-number">323</span><br><span class="line-number">324</span><br><span class="line-number">325</span><br><span class="line-number">326</span><br><span class="line-number">327</span><br><span class="line-number">328</span><br><span class="line-number">329</span><br><span class="line-number">330</span><br><span class="line-number">331</span><br><span class="line-number">332</span><br><span class="line-number">333</span><br><span class="line-number">334</span><br><span class="line-number">335</span><br><span class="line-number">336</span><br><span class="line-number">337</span><br><span class="line-number">338</span><br><span class="line-number">339</span><br><span class="line-number">340</span><br><span class="line-number">341</span><br><span class="line-number">342</span><br><span class="line-number">343</span><br><span class="line-number">344</span><br></div></div><h3 id="_1-6、存储过程"><a href="#_1-6、存储过程" class="header-anchor">#</a> 1.6、存储过程</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>--存储过程
create or replace procedure p
is
  cursor c
  is
    select * from emp2 for update;
begin
   for v_temp in c loop
      if (v_temp.deptno = 10) then
         update emp2 set sal = sal + 10 where current of c;
      elsif (v_temp.deptno = 20) then
         update emp2 set sal = sal + 20 where current of c;
      else
         update emp2 set sal = sal + 50 where current of c;
      end if;
    end loop;
    commit;
end;

--显示错误  
show error
--执行 
exec p;
或
begin;
 p;
end;


--带参数的存储过程  in 输入  out 输出
create or replace procedure p
     (v_a in number, v_b number, v_ret out number, v_temp in out number)
is
begin
   if (v_a &gt; v_b) then
      v_ret := v_a;
   else
      v_ret := v_b;
   end if;
   v_temp := v_temp + 1;
end;

--实验
declare
 v_a number := 3;
 v_b number := 4;
 v_ret number;
 v_temp number := 5;
begin
 p(v_a, v_b, v_ret, v_temp);
 dbms_output.put_line(v_ret);
 dbms_output.put_line(v_temp);
end;
-------------------


 create or replace procedure getNo(name in emp2.ename%type,no out emp2.empno%type) as
 eno emp2.empno%type;
 begin
 select empno into eno from emp2 where ename=name;
 dbms_output.put_line(eno);
 no:=eno;
 end;
 /


 declare
 name emp2.ename%type :='SMITH';
 no emp2.empno%type;
 begin
 getNo(name,no);
 dbms_output.put_line('---'||no);
 end;
 /


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br></div></div><h3 id="_1-7、函数与触发器"><a href="#_1-7、函数与触发器" class="header-anchor">#</a> 1.7、函数与触发器</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>
<span class="token comment">--函数</span>
<span class="token keyword">create</span> <span class="token operator">or</span> <span class="token keyword">replace</span> <span class="token keyword">function</span> sal_tax
  <span class="token punctuation">(</span>v_sal number<span class="token punctuation">)</span>
  <span class="token keyword">return</span> number
<span class="token operator">is</span>
<span class="token keyword">begin</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>v_sal <span class="token operator">&lt;</span> <span class="token number">2000</span><span class="token punctuation">)</span> <span class="token keyword">then</span>
      <span class="token keyword">return</span> <span class="token number">0.10</span><span class="token punctuation">;</span>
   elsif <span class="token punctuation">(</span>v_sal <span class="token operator">&lt;</span> <span class="token number">2750</span><span class="token punctuation">)</span> <span class="token keyword">then</span>
      <span class="token keyword">return</span> <span class="token number">0.15</span><span class="token punctuation">;</span>
   <span class="token keyword">else</span>
      <span class="token keyword">return</span> <span class="token number">0.20</span><span class="token punctuation">;</span>
   <span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>
<span class="token keyword">end</span>；

<span class="token keyword">select</span> sal_tax<span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>



<span class="token comment">--触发器</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> emp2_log
<span class="token punctuation">(</span>
uname varchar2<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token keyword">action</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
atime <span class="token keyword">date</span>
<span class="token punctuation">)</span>
<span class="token comment">-----------</span>
<span class="token keyword">create</span> <span class="token operator">or</span> <span class="token keyword">replace</span> <span class="token keyword">trigger</span> trig
  <span class="token keyword">after</span> <span class="token keyword">insert</span> <span class="token operator">or</span> <span class="token keyword">update</span> <span class="token operator">or</span> <span class="token keyword">delete</span> <span class="token keyword">on</span> emp2
<span class="token keyword">begin</span>
  <span class="token keyword">if</span> inserting <span class="token keyword">then</span>
     <span class="token keyword">insert</span> <span class="token keyword">into</span> emp2_log <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token keyword">USER</span><span class="token punctuation">,</span> <span class="token string">'insert'</span><span class="token punctuation">,</span> sysdate<span class="token punctuation">)</span><span class="token punctuation">;</span>
  elsif updating <span class="token keyword">then</span>
     <span class="token keyword">insert</span> <span class="token keyword">into</span> emp2_log <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token keyword">USER</span><span class="token punctuation">,</span> <span class="token string">'update'</span><span class="token punctuation">,</span> sysdate<span class="token punctuation">)</span><span class="token punctuation">;</span>
  elsif deleting <span class="token keyword">then</span>
     <span class="token keyword">insert</span> <span class="token keyword">into</span> emp2_log <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token keyword">USER</span><span class="token punctuation">,</span> <span class="token string">'delete'</span><span class="token punctuation">,</span> sysdate<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>

<span class="token comment">----------</span>
<span class="token keyword">update</span> emp2 <span class="token keyword">set</span> sal <span class="token operator">=</span> sal <span class="token operator">*</span> <span class="token number">2</span> <span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
<span class="token comment">--------</span>
<span class="token keyword">create</span> <span class="token operator">or</span> <span class="token keyword">replace</span> <span class="token keyword">trigger</span> trig
  <span class="token keyword">after</span> <span class="token keyword">insert</span> <span class="token operator">or</span> <span class="token keyword">update</span> <span class="token operator">or</span> <span class="token keyword">delete</span> <span class="token keyword">on</span> emp2 <span class="token keyword">for each row</span>
<span class="token keyword">begin</span>
  <span class="token keyword">if</span> inserting <span class="token keyword">then</span>
     <span class="token keyword">insert</span> <span class="token keyword">into</span> emp2_log <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token keyword">USER</span><span class="token punctuation">,</span> <span class="token string">'insert'</span><span class="token punctuation">,</span> sysdate<span class="token punctuation">)</span><span class="token punctuation">;</span>
  elsif updating <span class="token keyword">then</span>
     <span class="token keyword">insert</span> <span class="token keyword">into</span> emp2_log <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token keyword">USER</span><span class="token punctuation">,</span> <span class="token string">'update'</span><span class="token punctuation">,</span> sysdate<span class="token punctuation">)</span><span class="token punctuation">;</span>
  elsif deleting <span class="token keyword">then</span>
     <span class="token keyword">insert</span> <span class="token keyword">into</span> emp2_log <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token keyword">USER</span><span class="token punctuation">,</span> <span class="token string">'delete'</span><span class="token punctuation">,</span> sysdate<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
<span class="token comment">-------------</span>
<span class="token comment">--不提倡使用   改变被参考的主键</span>
<span class="token keyword">create</span> <span class="token operator">or</span> <span class="token keyword">replace</span> <span class="token keyword">trigger</span> trig
 <span class="token keyword">after</span> <span class="token keyword">update</span> <span class="token keyword">on</span> dept <span class="token keyword">for each row</span>
<span class="token keyword">begin</span>
 <span class="token keyword">update</span> emp2 <span class="token keyword">set</span> deptno <span class="token operator">=</span> :NEW<span class="token punctuation">.</span>deptno <span class="token keyword">where</span> deptno <span class="token operator">=</span> :OLD<span class="token punctuation">.</span>deptno<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
<span class="token comment">----------------------</span>



<span class="token comment">--树状结构的存储与展现</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> article<span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> article
<span class="token punctuation">(</span>
id number <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
cont varchar2<span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
pid number<span class="token punctuation">,</span>
isleaf number<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">--0代表非叶子节点，1代表叶子节点</span>
alevel number<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token comment">-------------</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> article <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'蚂蚁大战大象'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> article <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'大象被打趴下了'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> article <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'蚂蚁也不好过'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> article <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'瞎说'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> article <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'没有瞎说'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> article <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'怎么可能'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> article <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'怎么没可能'</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> article <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">'可能性是很大的'</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> article <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token string">'大象进医院了'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> article <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">'护士是蚂蚁'</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">commit</span><span class="token punctuation">;</span>
<span class="token comment">---------</span>
蚂蚁大战大象
   大象被打趴下了
      蚂蚁也不好过
      瞎说
         没有瞎说
      大象进医院了
         护士是蚂蚁
   怎么可能
         怎么不可能
         可能性是很大的
<span class="token comment">--------------------------</span>
<span class="token keyword">create</span> <span class="token operator">or</span> <span class="token keyword">replace</span> <span class="token keyword">procedure</span> p <span class="token punctuation">(</span>v_pid article<span class="token punctuation">.</span>pid<span class="token operator">%</span><span class="token keyword">type</span><span class="token punctuation">,</span> v_level binary_integer<span class="token punctuation">)</span> <span class="token operator">is</span>
  <span class="token keyword">cursor</span> c <span class="token operator">is</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> article <span class="token keyword">where</span> pid <span class="token operator">=</span> v_pid<span class="token punctuation">;</span>
  v_preStr varchar2<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span> :<span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token keyword">begin</span>
  <span class="token keyword">for</span> i <span class="token operator">in</span> <span class="token number">1.</span><span class="token punctuation">.</span>v_level <span class="token keyword">loop</span>
    v_preStr :<span class="token operator">=</span> v_preStr <span class="token operator">||</span> <span class="token string">'****'</span><span class="token punctuation">;</span>
  <span class="token keyword">end</span> <span class="token keyword">loop</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> v_article <span class="token operator">in</span> c <span class="token keyword">loop</span>
    dbms_output<span class="token punctuation">.</span>put_line<span class="token punctuation">(</span>v_preStr <span class="token operator">||</span> v_article<span class="token punctuation">.</span>cont<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>v_article<span class="token punctuation">.</span>isleaf <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">then</span>
    p <span class="token punctuation">(</span>v_article<span class="token punctuation">.</span>id<span class="token punctuation">,</span> v_level <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>
  <span class="token keyword">end</span> <span class="token keyword">loop</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>


<span class="token keyword">exec</span> p<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br></div></div><hr> <blockquote><p>序列与触发器</p></blockquote> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>
<span class="token comment">#创建序列</span>
<span class="token keyword">create</span> sequence t_user_id_seq <span class="token keyword">start</span> <span class="token keyword">with</span> <span class="token number">1</span> increment <span class="token keyword">by</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">#查看序列</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> user_sequences<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> user_sequences <span class="token keyword">WHERE</span> SEQUENCE_NAME<span class="token operator">=</span><span class="token string">'T_IDS_APPAUTH_SEQ'</span><span class="token punctuation">;</span>

<span class="token comment">#删除序列</span>
<span class="token keyword">DROP</span> SEQUENCE T_IDS_APPAUTH_SEQ<span class="token punctuation">;</span>


<span class="token comment">#创建触发器</span>
<span class="token keyword">create</span> <span class="token operator">or</span> <span class="token keyword">replace</span> <span class="token keyword">trigger</span> t_user_trigger 
before <span class="token keyword">insert</span> <span class="token keyword">on</span> t_user
<span class="token keyword">for each row</span>
<span class="token keyword">when</span><span class="token punctuation">(</span>new<span class="token punctuation">.</span>id <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span> <span class="token keyword">select</span> t_user_id_seq<span class="token punctuation">.</span>nextval <span class="token keyword">into</span>:NEW<span class="token punctuation">.</span>ID <span class="token keyword">from</span> dual<span class="token punctuation">;</span> <span class="token keyword">end</span><span class="token punctuation">;</span>

<span class="token comment">#查看触发器</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> user_triggers<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> user_triggers <span class="token keyword">where</span> TRIGGER_NAME<span class="token operator">=</span><span class="token string">'T_IDS_APPAUTH_TRIG'</span><span class="token punctuation">;</span>

<span class="token comment">#删除触发器</span>
<span class="token keyword">drop</span> <span class="token keyword">trigger</span> T_IDS_APPAUTH_TRIG<span class="token punctuation">;</span>


创建序列及触发器 自增ID
<span class="token keyword">CREATE</span> SEQUENCE T_TABLE_SEQ <span class="token keyword">START</span> <span class="token keyword">WITH</span> <span class="token number">1</span> INCREMENT <span class="token keyword">BY</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token operator">OR</span> <span class="token keyword">REPLACE</span> <span class="token keyword">TRIGGER</span> T_TABLE_TRIG 
BEFORE <span class="token keyword">INSERT</span> <span class="token keyword">ON</span> T_TABLE
<span class="token keyword">FOR EACH ROW</span>
<span class="token keyword">WHEN</span><span class="token punctuation">(</span>NEW<span class="token punctuation">.</span>ID <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span> <span class="token keyword">SELECT</span> T_TABLE_SEQ<span class="token punctuation">.</span>NEXTVAL <span class="token keyword">INTO</span>:NEW<span class="token punctuation">.</span>ID <span class="token keyword">FROM</span> DUAL<span class="token punctuation">;</span> <span class="token keyword">END</span>


查看表的约束条件有三个视图：dba_constraints、all_constraints、user_constraints
其中：dba_constraints视图需要DBA权限才能查询；
all_constraints、user_constraints普通用户查询。
例：<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> user_constraints<span class="token punctuation">;</span> 
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> user_constraints <span class="token keyword">where</span> constraint_name <span class="token operator">=</span> <span class="token string">'SYS_C00185187'</span><span class="token punctuation">;</span>


禁用约束
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> T_ORGUSER <span class="token keyword">DISABLE</span> <span class="token keyword">CONSTRAINT</span> constraint_SYS_C00185187<span class="token punctuation">;</span> 
启用约束
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">ENABLE</span> <span class="token keyword">CONSTRAINT</span> constraint_name<span class="token punctuation">;</span>  

https:<span class="token comment">//www.cnblogs.com/bingo1717/p/7792134.html</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br></div></div><h2 id="_2、基础操作"><a href="#_2、基础操作" class="header-anchor">#</a> 2、基础操作</h2> <h3 id="_2-1、登录"><a href="#_2-1、登录" class="header-anchor">#</a> 2.1、登录</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>
登陆 oracle账号    
cmd<span class="token operator">-</span>sqlplus<span class="token operator">-</span>scott<span class="token operator">-</span>tiger<span class="token punctuation">;</span> sqlplus scott<span class="token operator">/</span>tiger<span class="token punctuation">;</span>   <span class="token comment">//登陆oracle的普通用户账号</span>
sqlplus sys<span class="token operator">/</span>JAVA123o <span class="token keyword">as</span> sysdba<span class="token punctuation">;</span>                 <span class="token comment">//登陆oracle的sys账号</span>
sqlplus <span class="token operator">/</span> <span class="token keyword">as</span> sysdba<span class="token punctuation">;</span>				<span class="token comment">//以OS身份连接  </span>
sqlplus <span class="token operator">/</span>nolog<span class="token punctuation">;</span>					<span class="token comment">//直接进入SQLPLUS命令提示符 </span>
conn scott<span class="token operator">/</span>tiger<span class="token punctuation">;</span>				<span class="token comment">//切换用户，conn同connect </span>
conn sys<span class="token operator">/</span>sys <span class="token keyword">as</span> sysdba<span class="token punctuation">;</span>                         <span class="token comment">//以DBA的身份登录</span>


用户修改密码
conn sys <span class="token keyword">as</span> sysdba                                    <span class="token comment">//登陆sys账号</span>
<span class="token keyword">alter</span> <span class="token keyword">user</span> scott account <span class="token keyword">unlock</span> identified <span class="token keyword">by</span> tiger<span class="token punctuation">;</span>  <span class="token comment">//解锁，改密</span>


安装oracle蓝屏或者关机速度慢可以在管理服务里把oracle的相关服务改为延迟启动或者手动


sqlplus <span class="token operator">/</span>nolog只是登录进了SQLPLUS<span class="token punctuation">,</span>这个参数表示是不用<span class="token keyword">no</span> login的意思。此时并没有登录数据库。
所以需要再用<span class="token keyword">connect</span> username<span class="token operator">/</span>password连接上数据库
  
 
ORA<span class="token operator">-</span><span class="token number">01034</span>: ORACLE <span class="token operator">not</span> available ORA<span class="token operator">-</span><span class="token number">27101</span>: shared memory realm does <span class="token operator">not</span> exist
输入sqlplus <span class="token operator">/</span>nolog<span class="token punctuation">,</span>回车， 
这时出现了<span class="token keyword">SQL</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>然后再输入<span class="token keyword">connect</span> <span class="token operator">/</span> <span class="token keyword">as</span> sysdba<span class="token punctuation">;</span>回车<span class="token punctuation">,</span> 
再输入startup，回车，等待一会，等这个命令运行完之后，再连接数据库，就能进行查询、插入等正常操作


oracle登录sqlplus时，英文提示信息都是问号
<span class="token keyword">alter</span> system <span class="token keyword">set</span> nls_language<span class="token operator">=</span>american scope<span class="token operator">=</span>spfile<span class="token punctuation">;</span>


ORA<span class="token operator">-</span><span class="token number">01017</span>: invalid username<span class="token operator">/</span>password<span class="token punctuation">;</span> logon denied  登陆被拒绝（用户未解锁）
解决：
（<span class="token number">1</span>）conn sys<span class="token operator">/</span>sys <span class="token keyword">as</span> sysdba<span class="token punctuation">;</span><span class="token comment">//以DBA的身份登录</span>
（<span class="token number">2</span>）<span class="token keyword">alter</span> <span class="token keyword">user</span> scott account <span class="token keyword">unlock</span><span class="token punctuation">;</span><span class="token comment">// 然后解锁</span>
（<span class="token number">3</span>）conn scott<span class="token operator">/</span>tiger <span class="token comment">//弹出一个修改密码的对话框，修改一下密码就可以了</span>
 
具体操作步骤如下：
C:<span class="token operator">&gt;</span> sqlplus
请输入用户名：sys
输入口令：sys <span class="token keyword">as</span> sysdba <span class="token comment">//注意：在口令这里输入的密码后面必须要跟上 as sysdba 才可以。</span>
<span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">alter</span> <span class="token keyword">user</span> scott account <span class="token keyword">unlock</span><span class="token punctuation">;</span>
     用户已更改<span class="token punctuation">.</span>
<span class="token keyword">SQL</span><span class="token operator">&gt;</span> <span class="token keyword">commit</span><span class="token punctuation">;</span>
     提交完成<span class="token punctuation">.</span>
<span class="token keyword">SQL</span><span class="token operator">&gt;</span> conn scott<span class="token operator">/</span>tiger
更改scott口令
新口令：tiger
重新键入新口令：tiger
口令已更改
已连接。

另一种方法：你打开命令提示符，不要登录直接输入下面：
sqlplus sys<span class="token operator">/</span>tiger <span class="token keyword">as</span> sysdba
以dba方式进入sys帐户；
<span class="token keyword">alter</span> <span class="token keyword">user</span> scott account <span class="token keyword">unlock</span><span class="token punctuation">;</span>
给scott用户解锁；


登陆显示协议适配器错误
在控制面板<span class="token comment">--管理工具--服务中启动：（可以改为自动-延迟启动）</span>
OracleServiceORCL
OracleOraDb11g_home1TNSListener

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br></div></div><hr> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>
登录	
	<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> dba_directories<span class="token punctuation">;</span>
		SYS	DATA_PUMP_DIR	<span class="token operator">/</span>opt<span class="token operator">/</span>oracle<span class="token operator">/</span>admin<span class="token operator">/</span>orcl<span class="token operator">/</span>dpdump<span class="token operator">/</span>
	sqlplus saiwen_imp<span class="token operator">/</span>saiwen_imp	
		

将 idsweb<span class="token operator">-</span><span class="token number">2.0</span><span class="token punctuation">.</span>oracle<span class="token punctuation">.</span>dmp 文件上传到 <span class="token operator">/</span>opt<span class="token operator">/</span>saiwentech<span class="token operator">/</span>imp_oracle<span class="token operator">/</span><span class="token keyword">data</span>目录，进入容器（不需要登录oralc）执行导入导出命令。

导入idsweb<span class="token operator">-</span><span class="token number">2.0</span><span class="token punctuation">.</span>oracle<span class="token punctuation">.</span>dmp
	cp <span class="token operator">/</span>opt<span class="token operator">/</span>dbdata<span class="token operator">/</span><span class="token keyword">local</span><span class="token operator">/</span>idsweb<span class="token operator">-</span><span class="token number">2.0</span><span class="token punctuation">.</span>oracle<span class="token punctuation">.</span>dmp <span class="token operator">/</span>opt<span class="token operator">/</span>oracle<span class="token operator">/</span>admin<span class="token operator">/</span>orcl<span class="token operator">/</span>dpdump<span class="token operator">/</span>
	impdp saiwen_imp<span class="token operator">/</span>saiwen_imp DIRECTORY<span class="token operator">=</span>DATA_PUMP_DIR <span class="token keyword">DUMPFILE</span><span class="token operator">=</span>idsweb<span class="token operator">-</span><span class="token number">2.0</span><span class="token punctuation">.</span>oracle<span class="token punctuation">.</span>dmp REMAP_SCHEMA<span class="token operator">=</span>saiwen_imp:saiwen_imp
<span class="token comment">//  impdp account/password DIRECTORY=DATA_PUMP_DIR DUMPFILE=idsweb-2.0.oracle.dmp REMAP_SCHEMA=form:to</span>

导出idsweb<span class="token operator">-</span><span class="token number">2.0</span><span class="token punctuation">.</span>oracle<span class="token punctuation">.</span>dmp
	expdp saiwen_imp<span class="token operator">/</span>saiwen_imp  schemas<span class="token operator">=</span>saiwen_imp <span class="token keyword">dumpfile</span><span class="token operator">=</span>idsweb<span class="token operator">-</span><span class="token number">2.0</span><span class="token punctuation">.</span>oracle<span class="token punctuation">.</span>dmp directory<span class="token operator">=</span>DATA_PUMP_DIR<span class="token punctuation">;</span>
	cp <span class="token operator">/</span>opt<span class="token operator">/</span>oracle<span class="token operator">/</span>admin<span class="token operator">/</span>orcl<span class="token operator">/</span>dpdump<span class="token operator">/</span>idsweb<span class="token operator">-</span><span class="token number">2.0</span><span class="token punctuation">.</span>oracle<span class="token punctuation">.</span>dmp <span class="token operator">/</span>opt<span class="token operator">/</span>dbdata<span class="token operator">/</span><span class="token keyword">local</span><span class="token operator">/</span>


导入 Iframework_V4<span class="token punctuation">.</span><span class="token number">2</span>_scott_exp<span class="token punctuation">.</span>dmp
	cp <span class="token operator">/</span>opt<span class="token operator">/</span>dbdata<span class="token operator">/</span><span class="token keyword">local</span><span class="token operator">/</span>Iframework_V4<span class="token punctuation">.</span><span class="token number">2</span>_scott_exp<span class="token punctuation">.</span>dmp <span class="token operator">/</span>opt<span class="token operator">/</span>oracle<span class="token operator">/</span>admin<span class="token operator">/</span>orcl<span class="token operator">/</span>dpdump<span class="token operator">/</span>
	imp saiwen_imp<span class="token operator">/</span>saiwen_imp BUFFER<span class="token operator">=</span><span class="token number">64000</span> <span class="token keyword">FILE</span><span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>oracle<span class="token operator">/</span>admin<span class="token operator">/</span>orcl<span class="token operator">/</span>dpdump<span class="token operator">/</span>Iframework_V4<span class="token punctuation">.</span><span class="token number">2</span>_scott_exp<span class="token punctuation">.</span>dmp FROMUSER<span class="token operator">=</span>SCOTT TOUSER<span class="token operator">=</span>saiwen_imp


说明： DATA_PUMP_DIR 为oralce创建的目录，可用如下命令查询：
	 <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> dba_directories<span class="token punctuation">;</span>
	 
登录
	sqlplus <span class="token operator">/</span>nolog
	conn <span class="token operator">/</span> <span class="token keyword">as</span> sysdba
	sqlplus saiwen_imp<span class="token operator">/</span>password
	
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h3 id="_2-2、基础命令"><a href="#_2-2、基础命令" class="header-anchor">#</a> 2.2、基础命令</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>ed                 重新编辑  
/                  运行上一个
spool h:/1.txt     创建文件h:/1.txt来保存文件
spool of           保存文件
col mgr for 9999   设置列的宽度(在emp表，mgr为number）
col ename for a10  设置列的宽度(在emp表，ename为varchar）
set pagesize 20    设置页面长度
select * from tab; 查看当前用户所有的table
desc emp ;         查看emp的描述
show user;	   显示当前用户
--  /**/           单行和多行注释
purge recyclebin;  清空回收站
commit             提交
exit 		       退出


备份账户数据
1.导出数据   
cmd  exp     输入scott/tiger
2.创建用户、密码分配表空间、配额容量
create user xyq identified by xyq default tablespace users quota 10M on users;
3.分配权限 登陆权限、建表权限，建立视图权限
grant create session,create table,create view to xyq;
4.导入数据  首先输入新的用户名/密码   后面的输入scott
cmd imp


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>三范式--消除冗余数据 
第一范式：表要有主键，列不可分（唯一非空，不可重复；字段不可再分割）。
第二范式：多个字段组合成主键，其他字段不能依赖部分的主键。不能部分依赖。实体的属性完全依赖于主关键字。
第三范式：不能存在传递依赖。要求一个数据库表中不包含已在其它表中已包含的非主关键字信息。

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_2-3、添加字段"><a href="#_2-3、添加字段" class="header-anchor">#</a> 2.3、添加字段</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>
添加字段
	<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> T_IDS_APPAUTH <span class="token keyword">ADD</span> <span class="token punctuation">(</span>DYNAMICPASSLOGINENABLE NUMBER<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token string">'0'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> T_IDS_APPSYNCDETAIL <span class="token keyword">ADD</span> OPERCOUNT NUMBER<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">alter</span> <span class="token keyword">table</span> T_USER <span class="token keyword">add</span> WeChat NVARCHAR2<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">insert</span> <span class="token keyword">into</span> T_IDSCONFIG<span class="token punctuation">(</span>ID<span class="token punctuation">,</span>IDSKEY<span class="token punctuation">,</span><span class="token keyword">VALUE</span><span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token string">'Second login'</span><span class="token punctuation">,</span><span class="token string">'{&quot;displayName&quot;:&quot;二次登录&quot;,&quot;enabled&quot;:0}'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

设置主键
	<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> test_tab <span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> pk_test_tab <span class="token keyword">PRIMARY</span> <span class="token keyword">key</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

修改字段名：
　　<span class="token keyword">alter</span> <span class="token keyword">table</span> Student <span class="token keyword">rename</span> name <span class="token keyword">to</span> StuName<span class="token punctuation">;</span>

修改数据类型：
　　<span class="token keyword">alter</span> <span class="token keyword">table</span> Student <span class="token keyword">modify</span> <span class="token punctuation">(</span>id varchar2<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> T_ORG <span class="token keyword">MODIFY</span> FIRSTLETTERS VARCHAR2<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
	
	在oracle中，如果已经存在的数据的某些列，假如要更换字段类型的话，有的时候会出现

	错误：ORA<span class="token operator">-</span><span class="token number">01439</span>: <span class="token keyword">column</span> <span class="token keyword">to</span> be modified must be empty <span class="token keyword">to</span> change datatype 

    解决方法：把列数据复制出来，列置空后修改再恢复数据

    例如：

    <span class="token keyword">alter</span> <span class="token keyword">table</span> tablename <span class="token keyword">add</span> tempcolumn varchar2<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">--添加临时字段</span>

    tempcolumn <span class="token keyword">update</span> tablename <span class="token keyword">set</span> tempcolumn<span class="token operator">=</span>colname<span class="token punctuation">;</span><span class="token comment">--将原字段数据复制到临时字段中</span>

    <span class="token keyword">update</span> tablename <span class="token keyword">set</span> colname<span class="token operator">=</span><span class="token boolean">null</span><span class="token punctuation">;</span><span class="token comment">--将原字段数据清空</span>

    <span class="token keyword">alter</span> <span class="token keyword">table</span> tablename <span class="token keyword">modify</span> colname xxx <span class="token punctuation">;</span><span class="token comment">--修改原字段类型为xxx</span>

    <span class="token keyword">update</span> tablename <span class="token keyword">set</span> colname<span class="token operator">=</span> tempcolumn<span class="token punctuation">;</span><span class="token comment">--将临时字段数据复制到修改后的原字段</span>

    <span class="token keyword">alter</span> <span class="token keyword">table</span> tablename <span class="token keyword">drop</span> <span class="token keyword">column</span> tempcolumn<span class="token punctuation">;</span><span class="token comment">--删除临时字段</span>
	
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h3 id="_2-4、分页排序"><a href="#_2-4、分页排序" class="header-anchor">#</a> 2.4、分页排序</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>
分页排序
　select rownum rn ,a.* from USER_INFO a order by A.USERAGE desc;

	SELECT * FROM  
	(  
	SELECT A.*, ROWNUM RN  
	FROM (SELECT * FROM TABLE_NAME) A  
	WHERE ROWNUM &lt;= 40  
	)  
	WHERE RN &gt;= 21
	

	
oracle查询:分组查询，取出每组中的第一条记录			
https://blog.csdn.net/yatou5211/article/details/53764676			
SELECT * FROM(
SELECT z.type , z.code ,ROW_NUMBER()
OVER(PARTITION BY z.type ORDER BY z.code) AS code_id
FROM group_info z
)
WHERE code_id =1;

	
oracle   dt = session.query(sql, new Integer[]{rowBeginIndex+rows,rowBeginIndex});	
mysql    dt = session.query(sql, new Integer[]{rowBeginIndex,rows});


create sequence HIBERNATE_SEQUENCE start with 1 increment by 1;



进程报错  maximum number of processes (150) exceeded ：
	sqlplus /nolog
	conn /as sysdba;

	show parameter processes;

	alter system set processes = 2000  scope = spfile;

	shutdown immediate;

	startup;


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><h3 id="_2-5、oracle的数据类型"><a href="#_2-5、oracle的数据类型" class="header-anchor">#</a> 2.5、oracle的数据类型</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code>oracle的数据类型

<span class="token function">VARCHAR2</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span>   
可变长度的字符串<span class="token punctuation">,</span>其最大长度为size个字节<span class="token punctuation">;</span>size的最大值是<span class="token number">4000</span><span class="token punctuation">,</span>而最小值是<span class="token number">1</span><span class="token punctuation">;</span>你必须指定一个<span class="token constant">VARCHAR2</span>的size<span class="token punctuation">;</span>   

<span class="token function">NVARCHAR2</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span>   
可变长度的字符串<span class="token punctuation">,</span>依据所选的国家字符集<span class="token punctuation">,</span>其最大长度为size个字符或字节<span class="token punctuation">;</span>size的最大值取决于储存每个字符所需的字节数<span class="token punctuation">,</span>其上限为<span class="token number">4000</span><span class="token punctuation">;</span>你必须指定一个<span class="token constant">NVARCHAR2</span>的size<span class="token punctuation">;</span>   

<span class="token function">NUMBER</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>s<span class="token punctuation">)</span>   
精度为p并且数值范围为s的数值<span class="token punctuation">;</span>精度p的范围从<span class="token number">1</span>到<span class="token number">38</span><span class="token punctuation">;</span>数值范围s的范围是从<span class="token operator">-</span><span class="token number">84</span>到<span class="token number">127</span><span class="token punctuation">;</span> 
例如<span class="token operator">:</span><span class="token function">NUMBER</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>   表示整数部分最大<span class="token number">3</span>位，小数部分为<span class="token number">2</span>位； 
<span class="token function">NUMBER</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>   表示数的整数部分最大为<span class="token number">7</span>其中对整数的倒数<span class="token number">2</span>位为<span class="token number">0</span><span class="token punctuation">,</span>前面的取整。
 
<span class="token constant">NUMBER</span>   
表示使用默认值<span class="token punctuation">,</span>即等同于<span class="token function">NUMBER</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   

<span class="token constant">LONG</span>   
可变长度的字符数据<span class="token punctuation">,</span>其长度可达<span class="token number">2</span>G个字节<span class="token punctuation">;</span> 
  
<span class="token constant">DATE</span>   
有效日期范围从公元前<span class="token number">4712</span>年<span class="token number">1</span>月<span class="token number">1</span>日到公元后<span class="token number">4712</span>年<span class="token number">12</span>月<span class="token number">31</span>日 
  
<span class="token function">RAW</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span>   
长度为size字节的原始二进制数据<span class="token punctuation">,</span>size的最大值为<span class="token number">2000</span>字节；你必须为<span class="token constant">RAW</span>指定一个size<span class="token punctuation">;</span>   

<span class="token constant">LONG</span>   <span class="token constant">RAW</span>   
可变长度的原始二进制数据，其最长可达<span class="token number">2</span>G字节<span class="token punctuation">;</span>
   
<span class="token function">CHAR</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span>   
固定长度的字符数据<span class="token punctuation">,</span>其长度为size个字节<span class="token punctuation">;</span>size的最大值是<span class="token number">2000</span>字节<span class="token punctuation">,</span>而最小值和默认值是<span class="token number">1</span><span class="token punctuation">;</span> 
  
<span class="token function">NCHAR</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span>   
也是固定长度。根据<span class="token class-name">Unicode</span>标准定义 
  
<span class="token constant">CLOB</span>   
一个字符大型对象<span class="token punctuation">,</span>可容纳单字节的字符<span class="token punctuation">;</span>不支持宽度不等的字符集<span class="token punctuation">;</span>最大为<span class="token number">4</span>G字节 
  
<span class="token constant">NCLOB</span>   
一个字符大型对象<span class="token punctuation">,</span>可容纳单字节的字符<span class="token punctuation">;</span>不支持宽度不等的字符集<span class="token punctuation">;</span>最大为<span class="token number">4</span>G字节<span class="token punctuation">;</span>储存国家字符集
   
<span class="token constant">BLOB</span>   
一个二进制大型对象<span class="token punctuation">;</span>最大<span class="token number">4</span>G字节
   
<span class="token constant">BFILE</span>   
包含一个大型二进制文件的定位器<span class="token punctuation">,</span>其储存在数据库的外面；使得可以以字符流<span class="token class-name">I</span><span class="token operator">/</span><span class="token class-name">O</span>访问存在数据库服务器上的外部<span class="token constant">LOB</span><span class="token punctuation">;</span>最大大小为<span class="token number">4</span>G字节<span class="token punctuation">.</span>


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><h2 id="_3、其他问题"><a href="#_3、其他问题" class="header-anchor">#</a> 3、其他问题</h2> <h3 id="_3-1、mysql转oracle"><a href="#_3-1、mysql转oracle" class="header-anchor">#</a> 3.1、mysql转oracle</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>mysql ---&gt;  oracle 全部要大写

int(11) PRIMARY KEY NOT NULL AUTO_INCREMENT  
&quot;Id&quot; int(11) NOT NULL AUTO_INCREMENT           ----&gt;    &quot;ID&quot; NUMBER(11) NOT NULL      PRIMARY KEY (&quot;ID&quot;)  创建序列及触发器 自增ID

varchar ----&gt;   NVARCHAR2

int  ----&gt;  NUMBER

text  ----&gt;   NVARCHAR2(2000)   CLOB 

datetime ----&gt; DATE

时间比较
	to_date('2018-10-01 00:00:00','yyyy-mm-dd hh24:mi:ss')
	
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="_3-2、创建外键约束"><a href="#_3-2、创建外键约束" class="header-anchor">#</a> 3.2、创建外键约束</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>oracle创建外键约束有两种方法：

1、创建表时直接创建外键约束
create table books(
    bookid number(10) not null primary key,
    bookName varchar2(20) not null,
    price number(10,2),
    categoryId number(10) not null references Category(id)  --外键约束
);


2、先创建表，表创建成功后，单独添加外键约束
create table books(
    bookid number(10) not null primary key,
    bookName varchar2(20) not null,
    price number(10,2),
    categoryId number(10) not null
);
ALTER TABLE  books ADD CONSTRAINT FK_Book_categoryid FOREIGN KEY(categoryId ) REFERENCES Category(id);

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>
三种外键约束的建立语法如下：

例如有两张表 父表T_INVOICE主键ID。子表T_INVOICE_DETAIL外键字段INVOICE_ID

1、普通外键约束：
ALTER TABLE T_INVOICE_DETAIL ADD CONSTRAINT FK_INVOICE_ID FOREIGN KEY(INVOICE_ID ) REFERENCES T_INVOICE(ID);

2、级联外键约束：
ALTER TABLE T_INVOICE_DETAIL ADD CONSTRAINT FK_INVOICE_ID FOREIGN KEY(INVOICE_ID ) REFERENCES T_INVOICE(ID) ON DELETE CASCADE;

3、置空外键约束：
ALTER TABLE T_INVOICE_DETAIL ADD CONSTRAINT FK_INVOICE_ID FOREIGN KEY(INVOICE_ID ) REFERENCES T_INVOICE(ID) ON DELETE SET NULL;

alter table unique_test add constraint email_unique unique(email);

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="_3-3、调整字段顺序"><a href="#_3-3、调整字段顺序" class="header-anchor">#</a> 3.3、调整字段顺序</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>
一、调整oracle表中字段显示顺序：用系统用户
调整oracle表中字段显示顺序	此操作要在系统用户下执行，否则未授权错误 <span class="token punctuation">[</span>Err<span class="token punctuation">]</span> ORA<span class="token operator">-</span><span class="token number">01031</span>: insufficient <span class="token keyword">privileges</span>
<span class="token number">1</span>、查询出指定用户下的指定表的object_id

<span class="token keyword">select</span> object_id <span class="token keyword">from</span> all_objects <span class="token keyword">where</span> owner<span class="token operator">=</span><span class="token string">'test'</span> <span class="token operator">and</span> object_name<span class="token operator">=</span><span class="token string">'表名'</span>

<span class="token number">2</span>、根据object_id查询出表字段实际的顺序

<span class="token keyword">select</span> obj<span class="token comment">#,col#,name from sys.col$ where obj#=79119 ;</span>

<span class="token number">3</span>、通过<span class="token keyword">update</span>更改字段的实际顺序。

<span class="token keyword">update</span> sys<span class="token punctuation">.</span>col$ <span class="token keyword">set</span> col<span class="token comment">#=7 where obj#=79119 and name='字段名'</span>

<span class="token keyword">update</span> sys<span class="token punctuation">.</span>col$ <span class="token keyword">set</span> col<span class="token comment">#=4 where obj#=(select object_id from all_objects where owner='ZS12_IMP' and object_name='T_IDS_APPAUTH' ) and name='RESPONSEIMPL';</span>


二、调整oracle表中字段显示顺序：删除原表

如果要修改字段顺序，一般情况可以使用以下步骤（注意外键）：
<span class="token comment">--（1）备份目标表数据</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> T_IDS_APPAUTH2 <span class="token keyword">as</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> T_IDS_APPAUTH<span class="token punctuation">;</span>
<span class="token comment">--（2）drop 目标表</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> 目标表<span class="token punctuation">;</span>
<span class="token comment">--（3）再重新按照要求的字段顺序建表;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> 临时表 <span class="token punctuation">(</span>col1<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>coln<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">--（4）之后用select将数据从临时表导回。</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> T_USER_EXTRAINFO_OLD <span class="token keyword">as</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> T_USER_EXTRAINFO<span class="token punctuation">;</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> T_USER_EXTRAINFO<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;T_USER_EXTRAINFO&quot;</span> <span class="token punctuation">(</span>
  <span class="token string">&quot;USERID&quot;</span> NUMBER<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> T_USER<span class="token punctuation">(</span>ID<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">,</span>
  <span class="token string">&quot;FIELD1&quot;</span> NVARCHAR2<span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token string">&quot;FIELD2&quot;</span> NVARCHAR2<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token string">&quot;FIELD3&quot;</span> NVARCHAR2<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token string">&quot;FIELD4&quot;</span> NVARCHAR2<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token string">&quot;FIELD5&quot;</span> NVARCHAR2<span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token string">&quot;FIELD6&quot;</span> NVARCHAR2<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token string">&quot;FIELD7&quot;</span> NVARCHAR2<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token string">&quot;FIELD8&quot;</span> NVARCHAR2<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token string">&quot;FIELD9&quot;</span> NVARCHAR2<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token string">&quot;FIELD10&quot;</span> NVARCHAR2<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token keyword">CONSTRAINT</span> T_USER_EXTRAINFO_UNIQUE <span class="token keyword">UNIQUE</span> <span class="token punctuation">(</span>USERID<span class="token punctuation">)</span>
<span class="token punctuation">)</span> 
<span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> T_USER_EXTRAINFO<span class="token punctuation">(</span><span class="token string">&quot;USERID&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;FIELD1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;FIELD2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;FIELD3&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;FIELD4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;FIELD5&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;FIELD6&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;FIELD7&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;FIELD8&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;FIELD9&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;FIELD10&quot;</span><span class="token punctuation">)</span> <span class="token keyword">select</span> <span class="token string">&quot;USERID&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;FIELD1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;FIELD2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;FIELD3&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;FIELD4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;FIELD5&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;FIELD6&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;FIELD7&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;FIELD8&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;FIELD9&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;FIELD10&quot;</span> <span class="token keyword">from</span> T_USER_EXTRAINFO_OLD<span class="token punctuation">;</span>


三、调整oracle表中字段显示顺序：删除原字段

 <span class="token operator">*</span> 由于oracle 不能调整字段顺序，也不能改变有数据的表的字段长度和类型。因此是采用如下方法来插入字段。
 <span class="token operator">*</span> 	   <span class="token number">1</span>、创建备份表；  <span class="token number">2</span>、删除多余字段<span class="token punctuation">(</span>注意外键<span class="token punctuation">)</span>；   <span class="token number">3</span>、按顺序添加字段；  <span class="token number">4</span>、从备份表中复制原数据  （<span class="token number">5</span>、删除备份表）
 <span class="token operator">*</span>     （如果表中没有数据，可以将表删除，然后按照需要的顺序创建新表）
 <span class="token operator">*</span>     某些日志文件数据比较大，如果采用上述方法，升级脚本速度可能相当慢。如果不需要日志文件，
 <span class="token operator">*</span>     可以在升级前将日志文件删除，涉及升级日志表有：认证日志（ T_IDS_LOGINLOG ）。

<span class="token comment">-- T_IDS_DATASOURCE 在 DbPassword 字段后添加 BaseDb</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> T_IDS_DATASOURCE_OLD <span class="token keyword">as</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> T_IDS_DATASOURCE<span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> T_IDS_DATASOURCE <span class="token keyword">DROP</span> <span class="token keyword">COLUMN</span> MONITOR<span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> T_IDS_DATASOURCE <span class="token keyword">DROP</span> <span class="token keyword">COLUMN</span> MONITORNOTICEUSER<span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> T_IDS_DATASOURCE <span class="token keyword">ADD</span> <span class="token string">&quot;BASEDB&quot;</span> NUMBER<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> T_IDS_DATASOURCE <span class="token keyword">ADD</span> <span class="token string">&quot;MONITOR&quot;</span> NUMBER<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> T_IDS_DATASOURCE <span class="token keyword">ADD</span> <span class="token string">&quot;MONITORNOTICEUSER&quot;</span> NVARCHAR2<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> T_IDS_DATASOURCE <span class="token keyword">ADD</span> <span class="token string">&quot;REMARK&quot;</span> NVARCHAR2<span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>

<span class="token keyword">merge</span> <span class="token keyword">into</span> T_IDS_DATASOURCE A  <span class="token keyword">using</span> T_IDS_DATASOURCE_OLD B
<span class="token keyword">on</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>id<span class="token operator">=</span>B<span class="token punctuation">.</span>id<span class="token punctuation">)</span>  
<span class="token keyword">when</span> <span class="token keyword">matched</span> <span class="token keyword">then</span>  
<span class="token keyword">update</span> <span class="token keyword">set</span> A<span class="token punctuation">.</span>MONITOR <span class="token operator">=</span> B<span class="token punctuation">.</span>MONITOR<span class="token punctuation">,</span>A<span class="token punctuation">.</span>MONITORNOTICEUSER <span class="token operator">=</span> B<span class="token punctuation">.</span>MONITORNOTICEUSER<span class="token punctuation">;</span>


ORA<span class="token operator">-</span><span class="token number">02270</span>：<span class="token keyword">no</span> matching <span class="token keyword">unique</span> <span class="token operator">or</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">for</span> this <span class="token keyword">column</span><span class="token operator">-</span>list<span class="token punctuation">(</span>此列列表的唯一或主键不匹配<span class="token punctuation">)</span>
错误说明：外键的定义必须是另外一张表的主键，否则就会报这个错

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br></div></div><hr></div> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vuepress-blog/编程/数据库/mysqlNote.html" class="prev">
        mysqlNote
      </a></span> <span class="next"><a href="/vuepress-blog/编程/数据库/ldapNote.html">
        ldapNote
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/vuepress-blog/assets/js/app.ee30669a.js" defer></script><script src="/vuepress-blog/assets/js/3.9cedbe4c.js" defer></script><script src="/vuepress-blog/assets/js/2.5f0b3217.js" defer></script><script src="/vuepress-blog/assets/js/20.e7530fec.js" defer></script><script src="/vuepress-blog/assets/js/87.a6cc83ea.js" defer></script>
  </body>
</html>
